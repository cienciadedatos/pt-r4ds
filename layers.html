<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Hadley Wickham, Mine Çetinkaya-Rundel, e Garrett Grolemund">
<title>R para Ciência de Dados (2ª edição) - 9&nbsp; ✅ Camadas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./EDA.html" rel="next">
<link href="./visualize.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script><script defer="" data-domain="r4ds.hadley.nz" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./visualize.html">✅ Visualizar</a></li><li class="breadcrumb-item"><a href="./layers.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">✅ Camadas</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R para Ciência de Dados (2ª edição)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/cienciadedatos/pt-r4ds/" title="Código fonte" class="quarto-navigation-tool px-1" aria-label="Código fonte"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo de leitor">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Boas-vindas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface-2e.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Prefácio da segunda edição</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Introdução</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./whole-game.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Visão geral</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">✅ Visualização de dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">✅ Fluxo de Trabalho: básico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">✅ Fluxo de trabalho: estilo de código</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">✅ Organizando os dados (<em>data tidying</em>)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">✅ Fluxo de trabalho: scripts e projetos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data import</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">✅ Fluxo de trabalho: obtendo ajuda</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Visualizar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./layers.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">✅ Camadas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EDA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Communication</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Transformar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logicals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">✅ Vetores lógicos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">✅ Números</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Strings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regexps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regular expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">✅ Fatores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datetimes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Dates and times</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missing-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">✅ Valores faltantes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./joins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Joins</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Importar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spreadsheets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Spreadsheets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">✅ Bancos de dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arrow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">✅ Arrow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rectangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Hierarchical data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./webscraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">✅ Raspagem de dados (<em>Web scraping</em>)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Programar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">✅ Funções</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Iteration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./base-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">✅ Um guia para o R base</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./communicate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Comunicar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">✅ Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto-formats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">✅ Formatos para Quarto</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Índice</h2>
   
  <ul>
<li>
<a href="#introdu%C3%A7%C3%A3o" id="toc-introdução" class="nav-link active" data-scroll-target="#introdu%C3%A7%C3%A3o"><span class="header-section-number">9.1</span> Introdução</a>
  <ul class="collapse">
<li><a href="#pr%C3%A9-requisitos" id="toc-pré-requisitos" class="nav-link" data-scroll-target="#pr%C3%A9-requisitos"><span class="header-section-number">9.1.1</span> Pré-requisitos</a></li>
  </ul>
</li>
  <li>
<a href="#mapeamento-est%C3%A9tico" id="toc-mapeamento-estético" class="nav-link" data-scroll-target="#mapeamento-est%C3%A9tico"><span class="header-section-number">9.2</span> Mapeamento estético</a>
  <ul class="collapse">
<li><a href="#exerc%C3%ADcios" id="toc-exercícios" class="nav-link" data-scroll-target="#exerc%C3%ADcios"><span class="header-section-number">9.2.1</span> Exercícios</a></li>
  </ul>
</li>
  <li>
<a href="#sec-geometric-objects" id="toc-sec-geometric-objects" class="nav-link" data-scroll-target="#sec-geometric-objects"><span class="header-section-number">9.3</span> Geometrias</a>
  <ul class="collapse">
<li><a href="#exerc%C3%ADcios-1" id="toc-exercícios-1" class="nav-link" data-scroll-target="#exerc%C3%ADcios-1"><span class="header-section-number">9.3.1</span> Exercícios</a></li>
  </ul>
</li>
  <li>
<a href="#facetas" id="toc-facetas" class="nav-link" data-scroll-target="#facetas"><span class="header-section-number">9.4</span> Facetas</a>
  <ul class="collapse">
<li><a href="#exerc%C3%ADcios-2" id="toc-exercícios-2" class="nav-link" data-scroll-target="#exerc%C3%ADcios-2"><span class="header-section-number">9.4.1</span> Exercícios</a></li>
  </ul>
</li>
  <li>
<a href="#transforma%C3%A7%C3%B5es-estat%C3%ADsticas" id="toc-transformações-estatísticas" class="nav-link" data-scroll-target="#transforma%C3%A7%C3%B5es-estat%C3%ADsticas"><span class="header-section-number">9.5</span> Transformações estatísticas</a>
  <ul class="collapse">
<li><a href="#exerc%C3%ADcios-3" id="toc-exercícios-3" class="nav-link" data-scroll-target="#exerc%C3%ADcios-3"><span class="header-section-number">9.5.1</span> Exercícios</a></li>
  </ul>
</li>
  <li>
<a href="#ajustes-de-posi%C3%A7%C3%A3o" id="toc-ajustes-de-posição" class="nav-link" data-scroll-target="#ajustes-de-posi%C3%A7%C3%A3o"><span class="header-section-number">9.6</span> Ajustes de posição</a>
  <ul class="collapse">
<li><a href="#exerc%C3%ADcios-4" id="toc-exercícios-4" class="nav-link" data-scroll-target="#exerc%C3%ADcios-4"><span class="header-section-number">9.6.1</span> Exercícios</a></li>
  </ul>
</li>
  <li>
<a href="#sistema-de-coordenadas" id="toc-sistema-de-coordenadas" class="nav-link" data-scroll-target="#sistema-de-coordenadas"><span class="header-section-number">9.7</span> Sistema de coordenadas</a>
  <ul class="collapse">
<li><a href="#exerc%C3%ADcios-5" id="toc-exercícios-5" class="nav-link" data-scroll-target="#exerc%C3%ADcios-5"><span class="header-section-number">9.7.1</span> Exercícios</a></li>
  </ul>
</li>
  <li><a href="#a-gram%C3%A1tica-dos-gr%C3%A1ficos-baseada-em-camadas" id="toc-a-gramática-dos-gráficos-baseada-em-camadas" class="nav-link" data-scroll-target="#a-gram%C3%A1tica-dos-gr%C3%A1ficos-baseada-em-camadas"><span class="header-section-number">9.8</span> A gramática dos gráficos baseada em camadas</a></li>
  <li><a href="#resumo" id="toc-resumo" class="nav-link" data-scroll-target="#resumo"><span class="header-section-number">9.9</span> Resumo</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/cienciadedatos/pt-r4ds/edit/main/layers.qmd" class="toc-action"><i class="bi bi-github"></i>Editar essa página</a></li><li><a href="https://github.com/cienciadedatos/pt-r4ds/issues/new" class="toc-action"><i class="bi empty"></i>Criar uma issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./visualize.html">✅ Visualizar</a></li><li class="breadcrumb-item"><a href="./layers.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">✅ Camadas</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-layers" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">✅ Camadas</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introdução" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="introdução">
<span class="header-section-number">9.1</span> Introdução</h2>
<p>No <a href="data-visualize.html" class="quarto-xref"><span>Capítulo 1</span></a>, você aprendeu muito mais do que apenas criar gráficos de dispersão, gráficos de barras e boxplots. Você aprendeu uma base que você pode usar para criar <em>qualquer</em> tipo de gráfico com o ggplot2.</p>
<p>Nesse capítulo, você irá expandir essa base conforme for aprendendo sobre a gramática dos gráficos baseada em camadas. Vamos começar explorando mais profundamente o mapeamento estético, as geometrias e as facetas. Em seguida, você aprenderá sobre as transformações estatísticas que acontecem nos bastidores quando o ggplot2 cria um gráfico. Essas transformações são usadas para calcular novos valores a serem plotados, como as alturas das barras em um gráfico de barras, ou as medianas em um boxplot. Você também irá aprender sobre ajustes de posição, os quais modificam como as geometrias são exibidas nos seus gráficos. Por fim, introduziremos brevemente o sistema de coordenadas.</p>
<p>Não iremos abordar todas as funções e opções para cada uma dessas camadas, mas guiaremos você pelas funcionalidades mais importantes e comumente utilizadas que são fornecidas pelo ggplot2. Além disso, apresentaremos a você pacotes que estendem as funcionalidades do ggplot2.</p>
<section id="pré-requisitos" class="level3" data-number="9.1.1"><h3 data-number="9.1.1" class="anchored" data-anchor-id="pré-requisitos">
<span class="header-section-number">9.1.1</span> Pré-requisitos</h3>
<p>Esse capítulo foca no ggplot2. Para acessar as páginas de ajuda e as funções utilizadas nesse capítulo, carregue o pacote tidyverse. Para acessar as bases de dados, carregaremos também o pacote dados. Ao rodar o código abaixo, esses dois pacotes serão carregados:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cienciadedatos/dados">dados</a></span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="mapeamento-estético" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="mapeamento-estético">
<span class="header-section-number">9.2</span> Mapeamento estético</h2>
<blockquote class="blockquote">
<p>“O maior valor de uma imagem está em quando ela nos força a perceber o que não esperávamos ver.” — John Tukey</p>
</blockquote>
<p>Lembre-se de que a base de dados <code>milhas</code> incluída no pacote dados contém 234 observações de 38 modelos de carros.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">milhas</span></span>
<span><span class="co">#&gt; # A tibble: 234 × 11</span></span>
<span><span class="co">#&gt;   fabricante modelo cilindrada   ano cilindros transmissao tracao cidade</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;     &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 audi       a4            1.8  1999         4 auto(l5)    d          18</span></span>
<span><span class="co">#&gt; 2 audi       a4            1.8  1999         4 manual(m5)  d          21</span></span>
<span><span class="co">#&gt; 3 audi       a4            2    2008         4 manual(m6)  d          20</span></span>
<span><span class="co">#&gt; 4 audi       a4            2    2008         4 auto(av)    d          21</span></span>
<span><span class="co">#&gt; 5 audi       a4            2.8  1999         6 auto(l5)    d          16</span></span>
<span><span class="co">#&gt; 6 audi       a4            2.8  1999         6 manual(m5)  d          18</span></span>
<span><span class="co">#&gt; # ℹ 228 more rows</span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: rodovia &lt;int&gt;, combustivel &lt;chr&gt;, classe &lt;chr&gt;</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Entre as variáveis da base <code>milhas</code> estão:</p>
<ol type="1">
<li><p><code>cilindrada</code>: O tamanho do motor de um carro, em litros. Uma variável numérica.</p></li>
<li><p><code>rodovia</code>: A eficiência de combustível do carro na rodovia, em milhas por galão (milhas). Um carro com baixa eficiência de combustível consome mais combustível do que um carro com alta eficiência, ao percorrerem a mesma distância. Uma variável numérica.</p></li>
<li><p><code>classe</code>: Tipo do carro. Uma variável categórica.</p></li>
</ol>
<p>Vamos começar visualizando a relação entre <code>cilindrada</code> e <code>rodovia</code> para várias <code>classe</code>s de carros. Podemos fazer isso com um gráfico de dispersão no qual as variáveis numéricas são mapeadas nos atributos estéticos <code>x</code> e <code>y</code> e a variável categórica é mapeada em um atributo estético como <code>color</code> (cor) ou <code>shape</code> (forma).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Esquerda</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span>, color <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direita</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span>, shape <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The shape palette can deal with a maximum of 6 discrete values because more</span></span>
<span><span class="co">#&gt; than 6 becomes difficult to discriminate</span></span>
<span><span class="co">#&gt; ℹ you have requested 7 values. Consider specifying shapes manually if you</span></span>
<span><span class="co">#&gt;   need that many have them.</span></span>
<span><span class="co">#&gt; Warning: Removed 62 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" alt="Dois gráficos de dispersão, lado a lado, ambos mostram a eficiência de combustível na rodovia versus o tamanho do motor dos carros e mostram uma associação negativa. No gráfico à esquerda, a classe é mapeada na estética de cor (color), resultando em cores diferentes para cada classe. No gráfico à direita, a classe é mapeada na estética de forma, resultando em diferentes formas de caracteres para cada classe, exceto para SUV. Cada gráfico vem com uma legenda que mostra a relação entre a cor ou a forma e as categorias da variável de classe." width="384"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" alt="Dois gráficos de dispersão, lado a lado, ambos mostram a eficiência de combustível na rodovia versus o tamanho do motor dos carros e mostram uma associação negativa. No gráfico à esquerda, a classe é mapeada na estética de cor (color), resultando em cores diferentes para cada classe. No gráfico à direita, a classe é mapeada na estética de forma, resultando em diferentes formas de caracteres para cada classe, exceto para SUV. Cada gráfico vem com uma legenda que mostra a relação entre a cor ou a forma e as categorias da variável de classe." width="384"></p>
</div>
</div>
</div>
<p>Quando <code>classe</code> é mapeada no atributo estético <code>shape</code> (forma), recebemos dois avisos:</p>
<blockquote class="blockquote">
<p>1: The shape palette can deal with a maximum of 6 discrete values because more than 6 becomes difficult to discriminate; you have 7. Consider specifying shapes manually if you must have them.</p>
<p>2: Removed 62 rows containing missing values (<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>).</p>
</blockquote>
<p>Ou seja:</p>
<blockquote class="blockquote">
<p>1: A paleta de formas pode lidar com no máximo 6 valores discretos, porque acima de 6 torna-se difícil discriminá-los; você tem 7. Considere especificar as formas manualmente caso elas sejam de fato necessárias.</p>
<p>2: 62 linhas contendo valores ausentes foram removidas (<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>).</p>
</blockquote>
<p>Uma vez que o ggplot2, por padrão, usa apenas seis formas por vez, grupos que ultrapassem essa quantidade não serão plotados quando você usar o atributo estético <code>shape</code> (forma). O segundo aviso está relacionado a esse primeiro: há 62 SUVs na base de dados e elas não foram plotadas.</p>
<p>De forma semelhante, podemos também mapear a variável <code>classe</code> nos atributos estéticos <code>size</code> (tamanho) ou <code>alpha</code> (transparência), as quais controlarão o tamanho e a transparência dos pontos, respectivamente.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Esquerda</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span>, size <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using size for a discrete variable is not advised.</span></span>
<span></span>
<span><span class="co"># Direita</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span>, alpha <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using alpha for a discrete variable is not advised.</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" alt="Dois gráficos de dispersão, lado a lado, ambos mostram a eficiência de combustível na rodovia versus o tamanho do motor dos carros e mostram uma associação negativa. No gráfico à esquerda, a classe é mapeada na estética de tamanho (size), resultando em tamanhos diferentes para cada classe. No gráfico à direita, a classe é mapeada na estética alpha, resultando em diferentes transparências para cada classe. Cada gráfico vem com uma legenda que mostra a relação entre o tamanho ou a transparência e as categorias da variável de classe." width="384"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" alt="Dois gráficos de dispersão, lado a lado, ambos mostram a eficiência de combustível na rodovia versus o tamanho do motor dos carros e mostram uma associação negativa. No gráfico à esquerda, a classe é mapeada na estética de tamanho (size), resultando em tamanhos diferentes para cada classe. No gráfico à direita, a classe é mapeada na estética alpha, resultando em diferentes transparências para cada classe. Cada gráfico vem com uma legenda que mostra a relação entre o tamanho ou a transparência e as categorias da variável de classe." width="384"></p>
</div>
</div>
</div>
<p>Esses dois gráficos também produzem um aviso:</p>
<blockquote class="blockquote">
<p>Using alpha for a discrete variable is not advised.</p>
</blockquote>
<p>Ou seja:</p>
<blockquote class="blockquote">
<p>Não é recomendado usar o atributo estético <code>alpha</code> (transparência) para uma variável discreta.</p>
</blockquote>
<p>Mapear uma variável discreta não ordenada (categórica), <code>classe</code>, em um atributo estético ordenado (<code>size</code> ou <code>alpha</code>) em geral não é uma boa ideia, porque implica em uma ordenação que não existe de fato.</p>
<p>Uma vez que você seleciona o atributo estético do mapeamento, o ggplot2 cuida do resto. Ele seleciona uma escala adequada para ser utilizada com esse atributo e constrói uma legenda que explica a relação entre as categorias e os valores. Para os atributos estéticos x e y, o ggplot2 não cria uma legenda, mas cria uma linha de eixo com marcas de escala e rótulos. Essa linha de eixo fornece a mesma informação que uma legenda: explica a correspondência entre as posições e os valores.</p>
<p>Você também pode definir manualmente as propriedades visuais da sua geometria ao incluí-las como um argumento da função geom (<em>fora</em> do <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>), ao invés de depender do mapeamento de uma variável para definir essa aparência. Por exemplo, podemos tornar todos os pontos do nosso gráfico azuis:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" alt="Gráfico de dispersão da eficiência de combustível na rodovia versus o tamanho do motor dos carros mostrando uma associação negativa. Todos os pontos são azuis." width="576"></p>
</figure>
</div>
</div>
</div>
<p>Aqui, a cor não traz informações sobre uma variável, apenas modifica a aparência do gráfico. Você vai precisar selecionar um valor que faça sentido para aquele atributo estético:</p>
<ul>
<li>O nome de uma cor como uma sequência de caracteres (texto) em inglês, por exemplo, <code>color = "blue"</code>
</li>
<li>O tamanho de um ponto em mm, por exemplo, <code>size = 1</code>
</li>
<li>O formato de um ponto como um número, por exemplo, <code>shape = 1</code>, como mostrado na <a href="#fig-shapes" class="quarto-xref">Figura&nbsp;<span>9.1</span></a>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-shapes" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Relação das formas e dos números que as representam: 0 - quadrado, 1 - círculo, 2 - triângulo com ponta para cima, 3 - sinal de mais, 4 - sinal cruzado, 5 - diamante, 6 - triângulo com ponta para baixo, 7 - sinal cruzado no interior de um quadrado, 8 - estrela, 9 - sinal de mais no interior de um diamante, 10 - sinal de mais no interior de um círculo, 11 - triângulos com ponta para cima e para baixo, 12 - sinal de mais no interior de um quadrado, 13 - sinal cruzado no interior de um círculo, 14 - triângulo com ponta para cima e quadrado, 15 - quadrado sólido, 16 - círculo sólido, 17 - triângulo com ponta para cima sólido, 18 - diamante sólido, 19 - círculo sólido, 20 - ponto (círculo menor), 21 - círculo preenchido em vermelho, 22 - quadrado preenchido em vermelho, 23 - diamante preenchido em vermelho, 24 - triângulo com ponta para cima preenchido em vermelho, 25 - triângulo com ponta para baixo preenchido em vermelho." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-shapes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="layers_files/figure-html/fig-shapes-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Relação das formas e dos números que as representam: 0 - quadrado, 1 - círculo, 2 - triângulo com ponta para cima, 3 - sinal de mais, 4 - sinal cruzado, 5 - diamante, 6 - triângulo com ponta para baixo, 7 - sinal cruzado no interior de um quadrado, 8 - estrela, 9 - sinal de mais no interior de um diamante, 10 - sinal de mais no interior de um círculo, 11 - triângulos com ponta para cima e para baixo, 12 - sinal de mais no interior de um quadrado, 13 - sinal cruzado no interior de um círculo, 14 - triângulo com ponta para cima e quadrado, 15 - quadrado sólido, 16 - círculo sólido, 17 - triângulo com ponta para cima sólido, 18 - diamante sólido, 19 - círculo sólido, 20 - ponto (círculo menor), 21 - círculo preenchido em vermelho, 22 - quadrado preenchido em vermelho, 23 - diamante preenchido em vermelho, 24 - triângulo com ponta para cima preenchido em vermelho, 25 - triângulo com ponta para baixo preenchido em vermelho." width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-shapes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;9.1: O R apresenta 25 formas que são identificadas por números. Algumas podem parecer duplicadas: por exemplo, 0, 15 e 22 são todas quadrados. A diferença entre elas vem da interação das estéticas <code>color</code> (cor) e <code>fill</code> (preenchimento). As formas vazadas (0–14) têm uma borda cuja cor é determinada pelo argumento <code>color</code>; as formas sólidas (15–20) são preenchidas com a cor definida em <code>color</code>; as formas preenchidas (21–24) têm a cor da sua borda definida por <code>color</code> e o seu preenchimento definido por <code>fill</code>. As figuras foram alinhadas de forma a manter formas semelhantes próximas umas das outras.
</figcaption></figure>
</div>
</div>
</div>
<p>Até o momento, nós discutimos os atributos estéticos que podem ser mapeados em um gráfico de dispersão ao usarmos uma geometria de ponto (<code>geom_point</code>). Você pode aprender mais sobre todas as possibilidades de mapeamentos estéticos na vinheta de especificações estéticas (em inglês): <a href="https://ggplot2.tidyverse.org/articles/ggplot2-specs.html" class="uri">https://ggplot2.tidyverse.org/articles/ggplot2-specs.html</a>.</p>
<p>Os atributos estéticos específicos que você pode usar em um gráfico dependem da geometria que você está utilizando para representar os dados. Na próxima seção, exploraremos mais a fundo as geometrias.</p>
<section id="exercícios" class="level3" data-number="9.2.1"><h3 data-number="9.2.1" class="anchored" data-anchor-id="exercícios">
<span class="header-section-number">9.2.1</span> Exercícios</h3>
<ol type="1">
<li><p>Crie um gráfico de dispersão de <code>rodovia</code> <em>vs.</em> <code>cilindrada</code> no qual os pontos sejam triângulos preenchidos em cor-de-rosa (<em>pink</em>).</p></li>
<li>
<p>Por que o código abaixo não resultou em um gráfico com pontos em azul?</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li><p>O que o atributo estético <code>stroke</code> faz? Com quais formas esse atributo estético funciona? (Dica: use <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">?geom_point</a></code>)</p></li>
<li><p>O que acontece se você mapear um atributo estético para algo que não seja o nome de uma variável, como <code>aes(color = cilindrada &lt; 5)</code>? Observe que você também precisará definir os atributos estéticos x e y.</p></li>
</ol></section></section><section id="sec-geometric-objects" class="level2" data-number="9.3"><h2 data-number="9.3" class="anchored" data-anchor-id="sec-geometric-objects">
<span class="header-section-number">9.3</span> Geometrias</h2>
<p>Qual a semelhança entre esses dois gráficos?</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" alt="Há dois gráficos. O gráfico à esquerda é um gráfico de dispersão da eficiência de combustível na rodovia versus o tamanho do motor dos carros e o gráfico à direita mostra uma curva suavizada que segue a trajetória da relação entre essas variáveis. O gráfico também exibe um intervalo de confiança ao redor da curva suavizada." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" alt="Há dois gráficos. O gráfico à esquerda é um gráfico de dispersão da eficiência de combustível na rodovia versus o tamanho do motor dos carros e o gráfico à direita mostra uma curva suavizada que segue a trajetória da relação entre essas variáveis. O gráfico também exibe um intervalo de confiança ao redor da curva suavizada." width="288"></p>
</div>
</div>
</div>
<p>Os dois gráficos contém a mesma variável x, a mesma variável y e descrevem os mesmos dados. Mas os gráficos não são idênticos. Cada um desses gráficos usa uma <code>geom</code> diferente para representar esses dados. O gráfico à esquerda usa a geometria de ponto (<code>point</code>), enquanto o gráfico à direita usa a geometria de suavização (<code>smooth</code>) e inclui uma linha suavizada ajustada aos dados.</p>
<p>Para alterar a geometria do seu gráfico, basta mudar a função <code>geom</code> adicionada ao <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. Por exemplo, para criar os gráficos acima você pode usar o seguinte código:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Esquerda</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direita</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cada função <code>geom</code> no ggplot2 recebe um argumento <code>mapping</code>, que pode ser definido tanto localmente, na camada <code>geom</code>, quanto globalmente, na camada <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. No entanto, nem todos os atributos estéticos irão funcionar com todas as geometrias. Você pode definir o formato (<code>shape</code>) de um ponto, mas não pode definir o “formato” de uma linha. Se você tentar fazer isso, o ggplot2 ignorará silenciosamente esse mapeamento estético. Por outro lado, você <em>pode</em> definir o tipo de linha (<code>linetype</code>) de uma linha. A função <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> irá desenhar uma linha diferente, com um tipo diferente de linha, para cada valor da variável que for mapeada em <code>linetype</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Esquerda</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span>, shape <span class="op">=</span> <span class="va">tracao</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direita</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span>, linetype <span class="op">=</span> <span class="va">tracao</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" alt="Dois gráficos da eficiência de combustível na rodovia versus o tamanho do motor dos carros. Os dados são representados por curvas suavizadas. No gráfico à esquerda, há três curvas suavizadas, todas com o mesmo tipo de linha. No gráfico à direita, há três curvas suavizadas com tipos de linhas diferentes (contínua, tracejada e tracejada longa) para cada tipo de tração. Em ambos os gráficos, são exibidos também os intervalos de confiança ao redor das curvas." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" alt="Dois gráficos da eficiência de combustível na rodovia versus o tamanho do motor dos carros. Os dados são representados por curvas suavizadas. No gráfico à esquerda, há três curvas suavizadas, todas com o mesmo tipo de linha. No gráfico à direita, há três curvas suavizadas com tipos de linhas diferentes (contínua, tracejada e tracejada longa) para cada tipo de tração. Em ambos os gráficos, são exibidos também os intervalos de confiança ao redor das curvas." width="288"></p>
</div>
</div>
</div>
<p>Aqui, o <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> separa os carros em três linhas com base na categoria de <code>tracao</code> à qual pertencem. Uma linha descreve todos os pontos pertencentes à categoria <code>4</code>, outra linha descreve os pontos pertencentes à categoria <code>d</code>, e uma terceira linha descreve todos os pontos pertencentes à categoria <code>t</code>. Aqui, <code>4</code> corresponde a tração nas quatro rodas, <code>d</code> corresponde a tração nas rodas dianteiras e <code>t</code> corresponde a tração nas rodas traseiras.</p>
<p>Se isso não fez muito sentido, podemos tornar essa relação mais óbvia ao sobrepor as linhas aos dados brutos e então colorir tudo de acordo com a <code>tracao</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span>, color <span class="op">=</span> <span class="va">tracao</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">tracao</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" alt="Um gráfico da eficiência de combustível na rodovia versus o tamanho do motor dos carros. Os dados estão representados por pontos (coloridos de acordo com a tração) bem como por uma linha suavizada (sendo que o tipo de linha é determinado com base no tipo de tração). O gráfico também exibe um intervalo de confiança ao redor das curvas suavizadas." width="576"></p>
</figure>
</div>
</div>
</div>
<p>Observe que esse gráfico contém duas geometrias no mesmo gráfico.</p>
<p>Muitas geometrias, como o <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code>, usam uma única geometria para representar várias linhas de dados. Para essas geometrias, você pode mapear o atributo estético <code>group</code> (grupo) a uma variável categórica para desenhar várias geometrias. O ggplot2 irá desenhar uma geometria separada para cada valor único da variável de agrupamento. Na prática, o ggplot2 agrupará automaticamente os dados para essas geometrias sempre que você mapear um atributo estético a uma variável discreta (como no exemplo com <code>linetype</code>). É conveniente contar com esse recurso porque o atributo estético <code>group</code>, por si só, não adiciona às geoms uma legenda ou características que permitam distinguir os grupos.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Esquerda</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Middle</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">tracao</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direita</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">tracao</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" alt="Três gráficos, todos mostrando a eficiência de combustível na rodovia no eixo y e o tamanho do motor dos carros no eixo x, com os dados sendo representados por uma curva suavizada. O primeiro gráfico inclui apenas essas duas variáveis, o gráfico ao centro apresenta três curvas suavizadas separadas para cada categoria de tração, e o gráfico à direita não apenas mostra as mesmas três curvas separadas para cada tipo de tração, como mostra cada curva em uma cor diferente, com uma legenda relacionando a cor à categoria de tração. Todos os gráficos exibem também intervalos de confiança ao redor das curvas." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" alt="Três gráficos, todos mostrando a eficiência de combustível na rodovia no eixo y e o tamanho do motor dos carros no eixo x, com os dados sendo representados por uma curva suavizada. O primeiro gráfico inclui apenas essas duas variáveis, o gráfico ao centro apresenta três curvas suavizadas separadas para cada categoria de tração, e o gráfico à direita não apenas mostra as mesmas três curvas separadas para cada tipo de tração, como mostra cada curva em uma cor diferente, com uma legenda relacionando a cor à categoria de tração. Todos os gráficos exibem também intervalos de confiança ao redor das curvas." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" alt="Três gráficos, todos mostrando a eficiência de combustível na rodovia no eixo y e o tamanho do motor dos carros no eixo x, com os dados sendo representados por uma curva suavizada. O primeiro gráfico inclui apenas essas duas variáveis, o gráfico ao centro apresenta três curvas suavizadas separadas para cada categoria de tração, e o gráfico à direita não apenas mostra as mesmas três curvas separadas para cada tipo de tração, como mostra cada curva em uma cor diferente, com uma legenda relacionando a cor à categoria de tração. Todos os gráficos exibem também intervalos de confiança ao redor das curvas." width="288"></p>
</div>
</div>
</div>
<p>Se você incluir mapeamentos em uma função geom, o ggplot2 irá tratá-los como mapeamentos locais para aquela camada. Ele usará esses mapeamentos para estender ou substituir mapeamentos globais <em>apenas para aquela camada</em>. Isso torna possível representar atributos estéticos diferentes em diferentes camadas.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" alt="Gráfico de dispersão da eficiência de combustível na rodovia versus o tamanho do motor dos carros, com os pontos coloridos de acordo com a classe do carro. Há a sopreposição de uma curva suavizada que acompanha a trajetória da relação entre a eficiência de combustível na rodovia e o tamanho do motor dos carros. O gráfico exibe também um intervalo de confiança ao redor da curva." width="576"></p>
</figure>
</div>
</div>
</div>
<p>Você pode usar essa mesma ideia para especificar dados (<code>data</code>) diferentes para cada camada. Aqui, nós utilizamos pontos vermelhos e círculos vazados para destacar carros com dois assentos. O argumento <code>data</code>, definido localmente na camada <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, substitui - apenas para essa camada - o argumento <code>data</code> definido globalmente na camada <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">milhas</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">classe</span> <span class="op">==</span> <span class="st">"2 assentos"</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">milhas</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">classe</span> <span class="op">==</span> <span class="st">"2 assentos"</span><span class="op">)</span>, </span>
<span>    shape <span class="op">=</span> <span class="st">"circle open"</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" alt="Gráfico de dispersão da eficiência de combustível na rodovia versus o tamanho do motor dos carros, no qual os pontos são coloridos de acordo com a classe do carro. Uma curva suavizada acompanha a trajetória da relação entre a eficiência de combustível na rodovia e o tamanho do motor dos carros compactos está sobreposta juntamente com um intervalo de confiança ao seu redor." width="576"></p>
</figure>
</div>
</div>
</div>
<p>As geometrias são os blocos de construção base do ggplot2. Você pode transformar completamente a aparência do seu gráfico ao alterar as geometrias que o compõem, e geoms diferentes podem mostrar diferentes características dos seus dados. Por exemplo, o histograma e o gráfico de densidade abaixo mostram que a distribuição de eficiência de combustível na rodovia é bimodal e assimétrica à direita, enquanto o boxplot mostra que há dois possíveis <em>outliers</em> (valores atípicos).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Esquerda</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Middle</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direita</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" alt="Três gráficos: histograma, gráfico de densidade e boxplot da eficiência de combustível na rodovia." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" alt="Três gráficos: histograma, gráfico de densidade e boxplot da eficiência de combustível na rodovia." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-16-3.png" class="img-fluid" alt="Três gráficos: histograma, gráfico de densidade e boxplot da eficiência de combustível na rodovia." width="288"></p>
</div>
</div>
</div>
<p>O ggplot2 oferece mais de 40 geoms, mas essas não cobrem todas as possibilidades de criação de gráficos. Se você precisar de uma geometria diferente, recomendamos procurá-la em pacotes de extensão, para ver se outra pessoa já a implementou (veja uma amostra em <a href="https://exts.ggplot2.tidyverse.org/gallery/" class="uri">https://exts.ggplot2.tidyverse.org/gallery/</a>). Por exemplo, o pacote <strong>ggridges</strong> (<a href="https://wilkelab.org/ggridges/" class="uri">https://wilkelab.org/ggridges</a>) é útil para construir <em>ridgeline plots</em> (gráficos de densidade sobrepostos), os quais podem ser úteis para visualizar as curvas de densidade de uma variável numérica para diferentes categorias de uma variável categórica. No gráfico a seguir, nós não apenas utilizamos uma nova geometria (<code><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges()</a></code>), mas também mapeamos a mesma variável a múltiplos atributos estéticos (<code>tracao</code> foi mapeada em <code>y</code>, <code>fill</code> e <code>color</code>), além de definirmos um atributo estético (<code>alpha = 0.5</code>) para tornar as curvas de densidade transparentes.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggridges/">ggridges</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rodovia</span>, y <span class="op">=</span> <span class="va">tracao</span>, fill <span class="op">=</span> <span class="va">tracao</span>, color <span class="op">=</span> <span class="va">tracao</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 1.28</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" alt="Curvas de densidade para eficiência de combustível na rodovia para carros com tração traseira, tração dianteira e tração nas quatro rodas representadas separadamente. A distribuição é bimodal e aproximadamente simétrica para os carros com trações traseira e nas quatro rodas, e unimodal e assimétrica à direita para carros com tração dianteira." width="576"></p>
</figure>
</div>
</div>
</div>
<p>O melhor lugar para obter uma visão abrangente de todas as geometrias oferecidas pelo ggplot2, assim como de todas as funções do pacote, é a página de referência: <a href="https://ggplot2.tidyverse.org/reference" class="uri">https://ggplot2.tidyverse.org/reference</a>. Para aprender mais sobre uma geometria específica, use a ajuda (por exemplo, <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">?geom_smooth</a></code>).</p>
<section id="exercícios-1" class="level3" data-number="9.3.1"><h3 data-number="9.3.1" class="anchored" data-anchor-id="exercícios-1">
<span class="header-section-number">9.3.1</span> Exercícios</h3>
<ol type="1">
<li><p>Qual geom você usaria para construir um gráfico de linha? E um boxplot? E um histograma? E um gráfico de área?</p></li>
<li>
<p>Anteriormente nesse capítulo nós utilizamos o argumento <code>show.legend</code> sem explicá-lo:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">tracao</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
</ol>
<pre><code>O que o argumento `show.legend = FALSE` faz nesse gráfico?
O que acontece se você o remove?
Por que você acha que o utilizamos anteriomente?</code></pre>
<ol start="3" type="1">
<li><p>O que o argumento <code>se</code> da geometria <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> faz?</p></li>
<li>
<p>Recrie o código em R necessário para gerar os gráficos abaixo. Observe que sempre que uma variável categórica é utilizada no gráfico, trata-se da variável <code>tracao</code>.</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" alt="Há seis gráficos de dispersão nessa figura, dispostos em uma grade 3x2. Em todos os gráficos, a eficiência de combustível na rodovia está no eixo y e o tamanho do motor dos carros está no eixo x. O primeiro gráfico mostra todos os pontos em preto, com uma curva suavizada sobreposta a deles. No segundo gráfico, os pontos também estão todos em preto, com curvas suavizadas separadas para cada tipo de tração sobrepostas. No terceiro gráfico, os pontos e as curvas suavizadas estão representadas em cores diferentes para cada tipo de tração. No quarto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, mas há uma única curva suavizada sobreposta ajustada a todos os dados. No quinto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, e curvas suavizadas separadas, com diferentes tipos de linhas, foram ajustadas a cada tipo de tração. E, finalmente, no sexto gráfico os pontos estão representados em cores diferentes para cada tipo de tração e eles apresentam uma borda branca espessa." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" alt="Há seis gráficos de dispersão nessa figura, dispostos em uma grade 3x2. Em todos os gráficos, a eficiência de combustível na rodovia está no eixo y e o tamanho do motor dos carros está no eixo x. O primeiro gráfico mostra todos os pontos em preto, com uma curva suavizada sobreposta a deles. No segundo gráfico, os pontos também estão todos em preto, com curvas suavizadas separadas para cada tipo de tração sobrepostas. No terceiro gráfico, os pontos e as curvas suavizadas estão representadas em cores diferentes para cada tipo de tração. No quarto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, mas há uma única curva suavizada sobreposta ajustada a todos os dados. No quinto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, e curvas suavizadas separadas, com diferentes tipos de linhas, foram ajustadas a cada tipo de tração. E, finalmente, no sexto gráfico os pontos estão representados em cores diferentes para cada tipo de tração e eles apresentam uma borda branca espessa." width="288"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid" alt="Há seis gráficos de dispersão nessa figura, dispostos em uma grade 3x2. Em todos os gráficos, a eficiência de combustível na rodovia está no eixo y e o tamanho do motor dos carros está no eixo x. O primeiro gráfico mostra todos os pontos em preto, com uma curva suavizada sobreposta a deles. No segundo gráfico, os pontos também estão todos em preto, com curvas suavizadas separadas para cada tipo de tração sobrepostas. No terceiro gráfico, os pontos e as curvas suavizadas estão representadas em cores diferentes para cada tipo de tração. No quarto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, mas há uma única curva suavizada sobreposta ajustada a todos os dados. No quinto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, e curvas suavizadas separadas, com diferentes tipos de linhas, foram ajustadas a cada tipo de tração. E, finalmente, no sexto gráfico os pontos estão representados em cores diferentes para cada tipo de tração e eles apresentam uma borda branca espessa." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid" alt="Há seis gráficos de dispersão nessa figura, dispostos em uma grade 3x2. Em todos os gráficos, a eficiência de combustível na rodovia está no eixo y e o tamanho do motor dos carros está no eixo x. O primeiro gráfico mostra todos os pontos em preto, com uma curva suavizada sobreposta a deles. No segundo gráfico, os pontos também estão todos em preto, com curvas suavizadas separadas para cada tipo de tração sobrepostas. No terceiro gráfico, os pontos e as curvas suavizadas estão representadas em cores diferentes para cada tipo de tração. No quarto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, mas há uma única curva suavizada sobreposta ajustada a todos os dados. No quinto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, e curvas suavizadas separadas, com diferentes tipos de linhas, foram ajustadas a cada tipo de tração. E, finalmente, no sexto gráfico os pontos estão representados em cores diferentes para cada tipo de tração e eles apresentam uma borda branca espessa." width="288"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-19-5.png" class="img-fluid" alt="Há seis gráficos de dispersão nessa figura, dispostos em uma grade 3x2. Em todos os gráficos, a eficiência de combustível na rodovia está no eixo y e o tamanho do motor dos carros está no eixo x. O primeiro gráfico mostra todos os pontos em preto, com uma curva suavizada sobreposta a deles. No segundo gráfico, os pontos também estão todos em preto, com curvas suavizadas separadas para cada tipo de tração sobrepostas. No terceiro gráfico, os pontos e as curvas suavizadas estão representadas em cores diferentes para cada tipo de tração. No quarto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, mas há uma única curva suavizada sobreposta ajustada a todos os dados. No quinto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, e curvas suavizadas separadas, com diferentes tipos de linhas, foram ajustadas a cada tipo de tração. E, finalmente, no sexto gráfico os pontos estão representados em cores diferentes para cada tipo de tração e eles apresentam uma borda branca espessa." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-19-6.png" class="img-fluid" alt="Há seis gráficos de dispersão nessa figura, dispostos em uma grade 3x2. Em todos os gráficos, a eficiência de combustível na rodovia está no eixo y e o tamanho do motor dos carros está no eixo x. O primeiro gráfico mostra todos os pontos em preto, com uma curva suavizada sobreposta a deles. No segundo gráfico, os pontos também estão todos em preto, com curvas suavizadas separadas para cada tipo de tração sobrepostas. No terceiro gráfico, os pontos e as curvas suavizadas estão representadas em cores diferentes para cada tipo de tração. No quarto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, mas há uma única curva suavizada sobreposta ajustada a todos os dados. No quinto gráfico, os pontos estão representados em cores diferentes para cada tipo de tração, e curvas suavizadas separadas, com diferentes tipos de linhas, foram ajustadas a cada tipo de tração. E, finalmente, no sexto gráfico os pontos estão representados em cores diferentes para cada tipo de tração e eles apresentam uma borda branca espessa." width="288"></p>
</div>
</div>
</div>
</li>
</ol></section></section><section id="facetas" class="level2" data-number="9.4"><h2 data-number="9.4" class="anchored" data-anchor-id="facetas">
<span class="header-section-number">9.4</span> Facetas</h2>
<p>No capítulo <a href="data-visualize.html" class="quarto-xref"><span>Capítulo 1</span></a> você aprendeu sobre a criação de facetas com a função <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>, que divide um gráfico em “subgráficos”, os quais exibem um subconjunto dos dados com base em uma variável categórica.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">cilindros</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" alt="Gráfico de dispersão da eficiência de combustível na rovodia versus o tamanho do motor dos carros, com facetas definidas pela quantidade de cilindros e divididas em duas linhas." width="576"></p>
</figure>
</div>
</div>
</div>
<p>Para que as facetas do seu gráfico sejam criadas com base em duas variáveis, troque a função <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> pela função <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code>. O primeiro argumento de <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code> também é uma fórmula, mas agora é uma fórmula com o seguinte formato: <code>linhas ~ colunas</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">tracao</span> <span class="op">~</span> <span class="va">cilindros</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" alt="Gráfico de dispersão da eficiência de combustível na rovodia versus o tamanho do motor dos carros, com facetas definidas pela quantidade de cilindros, nas linhas, e pelo tipo de tração, nas colunas. Isso resulta em 12 facetas que se organizam em uma grade 4x3. Algumas dessas facetas não têm observações: 5 cilíndros e tração nas 4 rodas, 4 ou 5 cilíndros e tração dianteira." width="576"></p>
</figure>
</div>
</div>
</div>
<p>Por padrão, cada uma dessas facetas compartilha a mesma escala e intervalo para os eixos x e y. Isso é útil quando você quer comparar os dados de facetas diferentes, mas pode ser limitante quando você quer visualizar melhor a relação entre as variáveis dentro de cada faceta. Definir, em uma função que cria facetas, o argumento <code>scales</code> como <code>"free"</code> permitirá escalas de diferentes nos eixos tanto das linhas quanto das colunas. Já <code>"free_x"</code> permitirá escalas diferentes apenas nas linhas e <code>"free_y"</code> permitirá escalas diferentes apenas nas colunas.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">tracao</span> <span class="op">~</span> <span class="va">cilindros</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" alt="Gráfico de dispersão da eficiência de combustível na rovodia versus o tamanho do motor dos carros, com facetas definidas pela quantidade de cilindros, nas linhas, e pelo tipo de tração, nas colunas. Isso resulta em 12 facetas que se organizam em uma grade 4x3. Algumas dessas facetas não têm observações: 5 cilíndros e tração nas 4 rodas, 4 ou 5 cilíndros e tração dianteira. As facetas de uma mesma linha compartilham a mesma escala no eixo y e as facetas em uma mesma coluna compartilham a mesma escala no eixo x." width="576"></p>
</figure>
</div>
</div>
</div>
<section id="exercícios-2" class="level3" data-number="9.4.1"><h3 data-number="9.4.1" class="anchored" data-anchor-id="exercícios-2">
<span class="header-section-number">9.4.1</span> Exercícios</h3>
<ol type="1">
<li><p>O que acontece se você criar facetas com uma variável contínua?</p></li>
<li>
<p>O que significam essas células vazias no gráfico acima com <code>facet_grid(tracao ~ cilindros)</code>? Execute o código a seguir. Como elas se relacionam com o gráfico que resulta desse código?</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tracao</span>, y <span class="op">=</span> <span class="va">cilindros</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li>
<p>Quais gráficos o código a seguir cria? O que o <code>.</code> faz?</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">tracao</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">cilindros</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li>
<p>Observe o primeiro gráfico criado por faceta abaixo:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">classe</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Quais são as vantagens de usar facetas ao invés do atributo estético <code>color</code>? Quais são as desvantagens? Como essas vantagens e desvantagens mudariam se você tivesse uma base de dados maior?</p>
</li>
<li><p>Leia <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">?facet_wrap</a></code>. O que o argumento <code>nrow</code> faz? O que o argumento <code>ncol</code> faz? Quais outras opções controlam o layout dos paineis individuais? Por que a função <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code> não tem os argumentos <code>nrow</code> e <code>ncol</code>?</p></li>
<li>
<p>Qual dos gráficos abaixo facilita a comparação do tamanho do motor (<code>cilindrada</code>) entre carros com diferentes tipos de tração? O que isso diz sobre quando colocar uma variável para criar facetas nas linhas ou colunas?</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">tracao</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">tracao</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li>
<p>Recrie o gráfico abaixo usando <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> ao invés de <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code>. Como as posições dos rótulos das facetas mudam?</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">tracao</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
</ol></section></section><section id="transformações-estatísticas" class="level2" data-number="9.5"><h2 data-number="9.5" class="anchored" data-anchor-id="transformações-estatísticas">
<span class="header-section-number">9.5</span> Transformações estatísticas</h2>
<p>Considere um gráfico de barras simples, construído com <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> ou <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code>. O gráfico abaixo mostra a quantidade total de diamantes na base de dados <code>diamante</code>, agrupados por <code>corte</code>. A base de dados <code>diamante</code>, do pacote <code>dados</code>, contém informações de ~54.000 diamantes, incluindo <code>preco</code>, <code>quilate</code>, <code>cor</code>, <code>transparencia</code> e <code>corte</code> de cada diamante. O gráfico mostra que há mais diamantes disponíveis com cortes de alta qualidade do que com cortes de baixa qualidade.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">diamante</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">corte</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" alt="Gráfico de barras da quantidade de cada corte de diamantes. Há aproximadamente 1500 diamantes com corte Justo, 5000 Bom, 12000 Muito Bom, 14000 Premium e 22000 Ideal." width="576"></p>
</figure>
</div>
</div>
</div>
<p>No eixo x, o gráfico mostra a variável <code>corte</code>, uma variável da base de dados <code>diamante</code>. No eixo y, ele mostra a contagem (em inglês, <em>count</em>), mas contagem não é uma variável contida em <code>diamante</code>! De onde vem essa contagem? Muitos gráficos, como os gráficos de dispersão, representam os valores brutos da sua base de dados. Outros gráficos, como os gráficos de barras, calculam novos valores para serem representados no gráfico:</p>
<ul>
<li><p>Gráficos de barras, histogramas e polígonos de frequência agrupam seus dados em intervalos e então representam no gráfico a contagem do intervalo, ou seja, a quantidade de observações contida em cada intervalo.</p></li>
<li><p><em>Smoothers</em> (suavizadores) ajustam um modelo aos seus dados e, em seguida, representam as predições deste modelo.</p></li>
<li><p>Gráficos boxplot calculam cinco medidas resumo da distribuição e então mostram esses valores como uma caixa com um formato específico.</p></li>
</ul>
<p>O algoritmo usado para calcular novos valores para um gráfico recebe o nome de <strong>stat</strong>, uma abreviação para o termo em inglês <em>statistical transformation</em> (ou seja, transformação estatística). <a href="#fig-vis-stat-bar" class="quarto-xref">Figura&nbsp;<span>9.2</span></a> mostra como esse processo funciona com o <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-vis-stat-bar" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Uma figura demonstrando os três passos para a criação de um gráfico de barras. Passo 1. geom_bar() começa com a base de dados diamante. Passo 2. geom_bar() transforma esses dados com a stat &quot;count&quot;, a qual retorna uma base de dados dos cortes e suas contagens. Passo 3. geom_bar() usa os dados transformados para construir o gráfico. corte é mapeado no eixo x e a contagem (count) é mapeada no eixo y.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-vis-stat-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/visualization-stat-bar.png" class="img-fluid figure-img" style="width:100.0%" alt="Uma figura demonstrando os três passos para a criação de um gráfico de barras. Passo 1. geom_bar() começa com a base de dados diamante. Passo 2. geom_bar() transforma esses dados com a stat &quot;count&quot;, a qual retorna uma base de dados dos cortes e suas contagens. Passo 3. geom_bar() usa os dados transformados para construir o gráfico. corte é mapeado no eixo x e a contagem (count) é mapeada no eixo y.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vis-stat-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;9.2: Ao criarmos um gráfico de barras, começamos com os dados brutos. Então, os agregamos para contar a quantidade de observações em cada barra. Finalmente, essa variável calculada (a contagem) é mapeada para o atributo estético do gráfico.
</figcaption></figure>
</div>
</div>
</div>
<p>Você pode descobrir qual stat uma geometria usa ao inspecionar o valor padrão do argumento <code>stat</code>. Por exemplo, <code>?geom_bar()</code> mostra que o valor padrão para <code>stat</code> é “count” (contagem), o que significa que <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> usa <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">stat_count()</a></code>. <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">stat_count()</a></code> está documentada na mesma página que <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>. Se você rolar a página, a seção chamada “Computed variables” (Variáveis calculadas) explica que ela calcula duas novas variáveis: <code>count</code> e <code>prop</code>.</p>
<p>Toda geometria tem uma stat padrão; e toda stat tem uma geometria padrão. Isso significa que você, em geral, pode usar geometrias sem se preocupar com a transformação estatística subjacente. No entanto, há três razões pelas quais você pode precisar usar uma stat explicitamente:</p>
<ol type="1">
<li>
<p>Você pode querer substituir a stat padrão. No código abaixo, nós mudamos a stat da <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> de “count” (o padrão) para “identity”. Isso nos deixa mapear a altura das barras para os valores brutos de uma variável y.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diamante</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">corte</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">corte</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" alt="Gráfico de barras da quantidade de cada corte de diamantes. Há aproximadamente 1500 diamantes com corte Justo, 5000 Bom, 12000 Muito Bom, 14000 Premium e 22000 Ideal." width="576"></p>
</figure>
</div>
</div>
</div>
</li>
<li>
<p>Você pode querer substituir o mapeamento padrão de variáveis transformadas para o atributo estético. Por exemplo, você pode querer mostrar um gráfico de barras com proporções, ao invés de contagens:</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">diamante</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">corte</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" alt="Gráfico de barras da proporção de cada corte de diamantes. Aproximadamente, os diamantes com corte Justo representam 0.03, Bom 0.09, Muito Bom 0.22, Premium 0.26 e Ideal 0.40." width="576"></p>
</figure>
</div>
</div>
</div>
<p>Para descobrir quais variáveis podem ser calculadas por stat, procure pela seção “computed variables” (“variáveis calculadas”) na ajuda do <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>.</p>
</li>
<li>
<p>Você pode querer chamar atenção, no seu código, para a transformação estatística utilizada. Por exemplo, você pode usar <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code>, que cria uma medida resumo dos valores de y para cada valor único de x, para destacar a medida resumo que você está calculando:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">diamante</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">corte</span>, y <span class="op">=</span> <span class="va">profundidade</span><span class="op">)</span>,</span>
<span>    fun.min <span class="op">=</span> <span class="va">min</span>,</span>
<span>    fun.max <span class="op">=</span> <span class="va">max</span>,</span>
<span>    fun <span class="op">=</span> <span class="va">median</span></span>
<span>  <span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" alt="Um gráfico com profundidade no eixo y e corte de diamantes no eixo x (com níveis justo, bom, muito bom, premium e ideal). Para cada tipo de corte, linhas verticais se estendem da profundidade mínima até a máxima para os diamantes naquela categoria de corte, e a profundidade mediana é indicada na linha com um ponto." width="576"></p>
</figure>
</div>
</div>
</div>
</li>
</ol>
<p>O ggplot2 oferece mais de 20 stats para você utilizar. Cada stat é uma função, então você pode obter ajuda da maneira usual, por exemplo, <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">?stat_bin</a></code>.</p>
<section id="exercícios-3" class="level3" data-number="9.5.1"><h3 data-number="9.5.1" class="anchored" data-anchor-id="exercícios-3">
<span class="header-section-number">9.5.1</span> Exercícios</h3>
<ol type="1">
<li><p>Qual é a geometria associada ao <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code> por padrão? Como você poderia reescrever o código para gerar o gráfico anterior usando uma função <code>geom</code> ao invés da função <code>stat</code>?</p></li>
<li><p>O que a função <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code> faz? No que ela difere da função <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>?</p></li>
<li><p>A maioria dos geoms e stats vêm em pares que quase sempre são usados em conjunto. Faça uma lista de todos os pares. O que eles têm em comum? (Dica: Leia a documentação.)</p></li>
<li><p>Quais variáveis o <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth()</a></code> calcula? Quais argumentos controlam o comportamento dessa função?</p></li>
<li>
<p>No nosso gráfico de barras de proporção, precisamos definir <code>group = 1</code>. Por que? Em outras palavras, qual é o problema com esses dois gráficos?</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">diamante</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">corte</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">diamante</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">corte</span>, fill <span class="op">=</span> <span class="va">cor</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
</ol></section></section><section id="ajustes-de-posição" class="level2" data-number="9.6"><h2 data-number="9.6" class="anchored" data-anchor-id="ajustes-de-posição">
<span class="header-section-number">9.6</span> Ajustes de posição</h2>
<p>Há mais um elemento mágico associado aos gráficos de barras. Você pode colorir um gráfico de barras usando o atributo estético <code>color</code> ou, de maneira mais útil, o atributo estético <code>fill</code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Esquerda</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tracao</span>, color <span class="op">=</span> <span class="va">tracao</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direita</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tracao</span>, fill <span class="op">=</span> <span class="va">tracao</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" alt="Dois gráficos de barras para os tipos de tração de carros. No primeiro gráfico, as barras têm bordas coloridas. No segundo gráfico, elas estão preenchidas com cores. As alturas das barras correspondem à quantidade de carros em cada categoria de tração." width="384"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" alt="Dois gráficos de barras para os tipos de tração de carros. No primeiro gráfico, as barras têm bordas coloridas. No segundo gráfico, elas estão preenchidas com cores. As alturas das barras correspondem à quantidade de carros em cada categoria de tração." width="384"></p>
</div>
</div>
</div>
<p>Observe o que acontece se você mapear o atributo estético de preenchimento (<code>fill</code>) para outra variável, como <code>classe</code>: as barras são empilhadas automaticamente. Cada retângulo colorido representa uma combinação de <code>tracao</code> e <code>classe</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tracao</span>, fill <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" alt="Gráfico de barras divididas pelo tipo de tração dos carros, onde cada barra é preenchida com cores diferentes para cada classe de carros. As alturas das barras correspondem à quantidade de carros em cada categoria de tração, e as alturas dos segmentos coloridos são proporcionais à quantidade de carros de uma determinada categoria de classe dentro de uma determinada categoria de tipo de tração." width="576"></p>
</figure>
</div>
</div>
</div>
<p>O empilhamento é realizado automaticamente usando o ajuste de posição especificado pelo argumento <code>position</code>. Se você não quer um gráfico de barras empilhadas, você pode usar uma das outras três opções: <code>"identity"</code>, <code>"dodge"</code> ou <code>"fill"</code>.</p>
<ul>
<li>
<p><code>position = "identity"</code> irá colocar cada objeto exatamente onde ele se encontra no contexto do gráfico. Essa opção não é muito útil para barras, porque elas se sobrepõem. Para visualizar essa sobreposição, precisamos tornar as barras ligeiramente transparentes, definindo <code>alpha</code> igual a um valor pequeno, ou completamente transparentes, definindo <code>fill = NA</code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Esquerda</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tracao</span>, fill <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direita</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tracao</span>, color <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" alt="Gráfico de barras divididas pelo tipo de tração dos carros, onde cada barra é preenchida com cores diferentes para cada classe de carros. As alturas das barras correspondem à quantidade de carros em cada categoria de tração, e as alturas dos segmentos coloridos são proporcionais à quantidade de carros de uma determinada categoria de classe dentro de uma determinada categoria de tipo de tração. No entanto, os segmentos se sobrepõem. No primeiro gráfico, as barras são preenchidas com cores transparentes e no segundo gráfico, elas são apenas contornadas com cor." width="384"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid" alt="Gráfico de barras divididas pelo tipo de tração dos carros, onde cada barra é preenchida com cores diferentes para cada classe de carros. As alturas das barras correspondem à quantidade de carros em cada categoria de tração, e as alturas dos segmentos coloridos são proporcionais à quantidade de carros de uma determinada categoria de classe dentro de uma determinada categoria de tipo de tração. No entanto, os segmentos se sobrepõem. No primeiro gráfico, as barras são preenchidas com cores transparentes e no segundo gráfico, elas são apenas contornadas com cor." width="384"></p>
</div>
</div>
</div>
<p>O ajuste de posição “identity” é mais útil para geoms 2D, como pontos (<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>), na qual esse ajuste é o padrão.</p>
</li>
<li><p><code>position = "fill"</code> funciona como <code>position = "stacked"</code>, mas faz com que cada conjunto de barras empilhadas tenha a mesma altura. Isso facilita a comparação de proporções entre grupos.</p></li>
<li>
<p><code>position = "dodge"</code> coloca objetos sobrepostos diretamente <em>ao lado</em> um do outro. Isso facilita a comparação de valores individuais.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Esquerda</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tracao</span>, fill <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direita</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tracao</span>, fill <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" alt="Na esquerda, gráfico de barras divididas pelo tipo de tração dos carros, onde cada barra é preenchida com cores diferentes para cada classe de carros. Todas as barras apresentam uma altura igual a 1 e as alturas dos segmentos coloridos correspondem à proporção de carros de uma determinada categoria de classe dentro de uma determinada categoria de tipo de tração. Na direita, gráfico de barras agrupadas para os tipos de tração de carros. As barras são agrupadas por categoria de tipo de tração. Dentro de cada grupo, as barras representam cada categoria de classe. Algumas classes são representadas em alguns tipos de tração e não são representadas em outros, resultando em um número desigual de barras dentro de cada grupo. As alturas dessas barras representam a quantidade de carros com um determinado tipo de tração e classe." width="384"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid" alt="Na esquerda, gráfico de barras divididas pelo tipo de tração dos carros, onde cada barra é preenchida com cores diferentes para cada classe de carros. Todas as barras apresentam uma altura igual a 1 e as alturas dos segmentos coloridos correspondem à proporção de carros de uma determinada categoria de classe dentro de uma determinada categoria de tipo de tração. Na direita, gráfico de barras agrupadas para os tipos de tração de carros. As barras são agrupadas por categoria de tipo de tração. Dentro de cada grupo, as barras representam cada categoria de classe. Algumas classes são representadas em alguns tipos de tração e não são representadas em outros, resultando em um número desigual de barras dentro de cada grupo. As alturas dessas barras representam a quantidade de carros com um determinado tipo de tração e classe." width="384"></p>
</div>
</div>
</div>
</li>
</ul>
<p>Há um outro tipo de ajuste que não é útil para gráficos de barras, mas pode ser muito útil para gráficos de dispersão. Lembre-se do nosso primeiro gráfico de dispersão. Você notou que o gráfico mostra apenas 126 pontos, mesmo que haja 234 observações no conjunto de dados?</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" alt="Gráfico de dispersão da eficiência de combustível na rovodia versus o tamanho do motor dos carros que mostra uma relação negativa entre essas variáveis." width="576"></p>
</figure>
</div>
</div>
</div>
<p>Os valores de <code>rodovia</code> e <code>cilindrada</code> são arredondados, então os pontos aparecem em uma grade e muitos pontos se sobrepõem. Esse problema é conhecido como <strong>sobreposição excessiva</strong> (em inglês, <em>overplotting</em>). Essa disposição dos pontos torna difícil visualizar a distribuição dos dados. Os pontos estão distribuídos de forma similiar ao longo do gráfico, ou há uma combinação especial de <code>rodovia</code> e <code>cilindrada</code> que contém 109 valores?</p>
<p>Você pode evitar essa sobreposição configurando o ajuste de posição para “jitter”. <code>position = "jitter"</code> adiciona uma pequena quantidade de ruído aleatório a cada ponto. Isso espalha os pontos porque é improvável que dois pontos recebam a mesma quantidade de ruído aleatório.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"jitter"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="layers_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" alt="Gráfico de dispersão, com &quot;jitter&quot;, da eficiência de combustível na rovodia versus o tamanho do motor dos carros. O gráfico mostra uma relação negativa entre essas variáveis." width="576"></p>
</figure>
</div>
</div>
</div>
<p>Adicionar aleatoriedade pode parecer uma maneira estranha de melhorar seu gráfico, mas ainda que isso torne o gráfico menos preciso em escalas pequenas, o torna <em>mais</em> revelador em grandes escalas. Já que essa é uma operação tão útil, o ggplot2 possui uma forma simplificada para <code>geom_point(position = "jitter")</code>: <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code>.</p>
<p>Para aprender mais sobre ajustes de posição, veja a página de ajuda referente a cada tipo de ajuste: <code><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">?position_dodge</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">?position_fill</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/position_identity.html">?position_identity</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">?position_jitter</a></code> e <code><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">?position_stack</a></code>.</p>
<section id="exercícios-4" class="level3" data-number="9.6.1"><h3 data-number="9.6.1" class="anchored" data-anchor-id="exercícios-4">
<span class="header-section-number">9.6.1</span> Exercícios</h3>
<ol type="1">
<li>
<p>Qual o problema com o gráfico abaixo? Como você poderia melhorá-lo?</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cidade</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li>
<p>Qual, caso exista, é a diferença entre os dois gráficos abaixo? Por que?</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li><p>Quais parâmetros do <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code> controlam a quantidade de “jittering” (ruído aleatório adicionado a cada ponto)?</p></li>
<li><p>Compare e aponte as diferenças entre <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code> e <code><a href="https://ggplot2.tidyverse.org/reference/geom_count.html">geom_count()</a></code>.</p></li>
<li><p>Qual é o ajuste de posição padrão para o <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>? Crie uma visualização com a base de dados <code>milhas</code> que demonstre isso.</p></li>
</ol></section></section><section id="sistema-de-coordenadas" class="level2" data-number="9.7"><h2 data-number="9.7" class="anchored" data-anchor-id="sistema-de-coordenadas">
<span class="header-section-number">9.7</span> Sistema de coordenadas</h2>
<p>Os sistemas de coordenadas são, provavelmente, a parte mais complicada do ggplot2. O sistema de coordenadas padrão é o sistema cartesiano, no qual as posições x e y atuam de forma independente para determinar a localização de cada ponto. Há outros dois sistemas de coordenadas que, ocasionalmente, são úteis.</p>
<ul>
<li>
<p><code><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_quickmap()</a></code> ajusta corretamente a proporção entre os eixos para mapas geográficos. Isso é muito importante se você estiver plotando dados espaciais com o ggplot2. Não temos espaço para discutir mapas neste livro, mas você pode aprender mais no <a href="https://ggplot2-book.org/maps.html">capítulo de Mapas</a> do livro <em>ggplot2: Elegant graphics for data analysis</em>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html">map_data</a></span><span class="op">(</span><span class="st">"nz"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nz</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nz</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_quickmap</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" alt="Dois mapas das fronteiras da Nova Zelândia. No primeiro gráfico, as proporções estão incorretas; no segundo gráfico, estão corretas." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid" alt="Dois mapas das fronteiras da Nova Zelândia. No primeiro gráfico, as proporções estão incorretas; no segundo gráfico, estão corretas." width="288"></p>
</div>
</div>
</div>
</li>
<li>
<p><code><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar()</a></code> usa coordenadas polares. As coordenadas polares revelam uma conexão interessante entre um gráfico de barras e um gráfico de rosa-dos-ventos (em inglês, <em>Coxcomb</em>).</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamante</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">transparencia</span>, fill <span class="op">=</span> <span class="va">transparencia</span><span class="op">)</span>, </span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bar</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bar</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" alt="Há dois gráficos. Na esquerda, há um gráfico de barras da transparência dos diamantes; na direita, há um gráfico rosa-dos-ventos com os mesmos dados." width="288"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="layers_files/figure-html/unnamed-chunk-43-2.png" class="img-fluid" alt="Há dois gráficos. Na esquerda, há um gráfico de barras da transparência dos diamantes; na direita, há um gráfico rosa-dos-ventos com os mesmos dados." width="288"></p>
</div>
</div>
</div>
</li>
</ul>
<section id="exercícios-5" class="level3" data-number="9.7.1"><h3 data-number="9.7.1" class="anchored" data-anchor-id="exercícios-5">
<span class="header-section-number">9.7.1</span> Exercícios</h3>
<ol type="1">
<li><p>Transforme um gráfico de barras empilhadas em um gráfico de pizza usando <code><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar()</a></code>.</p></li>
<li><p>Qual a diferença entre <code><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_quickmap()</a></code> e <code><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_map()</a></code>?</p></li>
<li>
<p>O que o gráfico abaixo te diz sobre a relação entre as variáveis cidade e rodovia? Por que <code><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed()</a></code> é importante? O que o <code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline()</a></code> faz?</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">milhas</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cidade</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
</ol></section></section><section id="a-gramática-dos-gráficos-baseada-em-camadas" class="level2" data-number="9.8"><h2 data-number="9.8" class="anchored" data-anchor-id="a-gramática-dos-gráficos-baseada-em-camadas">
<span class="header-section-number">9.8</span> A gramática dos gráficos baseada em camadas</h2>
<p>Nós podemos expandir o template para criação de um gráfico, que você aprendeu em <a href="data-visualize.html#sec-ggplot2-calls" class="quarto-xref"><span>Seção 1.3</span></a>, ao adicionar ajustes de posição, transformações estatísticas, sistemas de coordenadas e facetas:</p>
<pre><code>ggplot(data = &lt;DADOS&gt;) + 
  &lt;GEOM_FUNCTION&gt;(
     mapping = aes(&lt;MAPPINGS&gt;),
     stat = &lt;STAT&gt;, 
     position = &lt;POSITION&gt;
  ) +
  &lt;COORDINATE_FUNCTION&gt; +
  &lt;FACET_FUNCTION&gt;</code></pre>
<p>Nosso novo template recebe sete parâmetros, as palavras entre <code>&lt; &gt;</code> que aparecerem no template. Na prática, raramente será necessário fornecer esses sete parâmetros para construir um gráfico, porque o ggplot2 fornecerá valores padrão úteis para todos esses parâmetros, exceto os dados, o mapeamento estético e a função geom.</p>
<p>Os sete parâmetros do template compõem a gramática dos gráficos, um sistema formal para construir gráficos. A gramática dos gráficos é baseada na ideia de que é possível descrever, de forma única, <em>qualquer</em> gráfico como uma combinação de: um conjunto de dados, uma geometria, um mapeamento estético, uma transformação estatística, um ajuste de posição, um sistema de coordenadas, um esquema de facetas e um tema.</p>
<p>Para entender como isso funciona, considere como você poderia construir um gráfico básico do zero: você poderia começar com um conjunto de dados e, em seguida, transformá-lo nas informações que deseja mostrar (com uma transformação estatística). Em seguida, você poderia escolher uma geometria para representar cada observação dos dados transformados. Você poderia então usar os atributos estéticos das geometrias para representar variáveis presentes nesses dados. Você mapearia os valores de cada variável para cada mapeamento estético. Essas etapas estão ilustradas em <a href="#fig-visualization-grammar" class="quarto-xref">Figura&nbsp;<span>9.3</span></a>. Em seguida, você selecionaria um sistema de coordenadas para posicionar as geometrias, usando a localização dos objetos (que é em si um atributo estético) para exibir os valores das variáveis x e y.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-visualization-grammar" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Uma figura que mostra as etapas para ir de dados brutos a uma tabela de frequências na qual cada linha representa uma categoria de corte e uma coluna de contagem mostra quantos diamantes estão naquela categoria de corte. Em seguida, esses valores são mapeados para alturas de barras. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-visualization-grammar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/visualization-grammar.png" class="img-fluid figure-img" alt="Uma figura que mostra as etapas para ir de dados brutos a uma tabela de frequências na qual cada linha representa uma categoria de corte e uma coluna de contagem mostra quantos diamantes estão naquela categoria de corte. Em seguida, esses valores são mapeados para alturas de barras. " width="1332">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-visualization-grammar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;9.3: Etapas para ir de dados brutos a uma tabela de frequências e então a um gráfico de barras no qual a altura das barras representa as frequências.
</figcaption></figure>
</div>
</div>
</div>
<p>A essa altura, você teria um gráfico completo, mas poderia ir além e ajustar as posições das geoms no sistema de coordenadas (com ajustes de posição) ou dividir o gráfico em subgráficos (criando facetas). Você também poderia adicionar informações ao gráfico ao adicionar uma ou mais camadas. Cada camada adicional usará uma base de dados, uma geometria, um conjunto de mapeamentos estéticos, uma transformação estatística e um ajuste de posição.</p>
<p>Você pode usar esse método para construir <em>qualquer</em> gráfico que imaginar. Em outras palavras, você pode usar o template de código que aprendeu neste capítulo para construir centenas de milhares de gráficos distintos.</p>
<p>Caso queira aprender mais sobre os fundamentos teóricos do ggplot2, você pode ler “<a href="https://vita.had.co.nz/papers/layered-grammar.pdf">The Layered Grammar of Graphics</a>”, o artigo científico que descreve detalhadamente a teoria do ggplot2.</p>
</section><section id="resumo" class="level2" data-number="9.9"><h2 data-number="9.9" class="anchored" data-anchor-id="resumo">
<span class="header-section-number">9.9</span> Resumo</h2>
<p>Neste capítulo você aprendeu sobre a gramática dos gráficos baseada em camadas, começando com atributos estéticos e geometrias para construir um gráfico simples, facetas para dividir o gráfico em subgráficos, transformações estatísticas para entender como as geometrias são calculadas, ajustes de posição para controlar de forma precisa essas posições quando as geometrias se sobrepõem e sistemas de coordenadas que permitem modificar o que <code>x</code> e <code>y</code> significam. Uma camada que ainda não abordamos é o tema (<code>theme</code>), que será introduzida em <a href="communication.html#sec-themes" class="quarto-xref"><span>Seção 11.5</span></a>.</p>
<p>Dois recursos muito úteis para ter uma visão geral do funcionamento completo do ggplot2 são: a <em>cheatsheet</em> do ggplot2 (que você encontra, em inglês, em <a href="https://posit.co/resources/cheatsheets" class="uri">https://posit.co/resources/cheatsheets</a>) e o site do pacote ggplot2, também em inglês (<a href="https://ggplot2.tidyverse.org/">https://ggplot2.tidyverse.org</a>).</p>
<p>Uma lição importante que você deve tirar deste capítulo é que, quando sentir a necessidade de uma geometria que não é fornecida pelo ggplot2, é sempre uma boa ideia verificar se alguém já resolveu seu problema criando um pacote de extensão do ggplot2 que ofereça essa geometria.</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./visualize.html" class="pagination-link  aria-label=" visualizar="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">✅ Visualizar</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./EDA.html" class="pagination-link" aria-label="<span class='chapter-number'>10</span>&nbsp; <span class='chapter-title'>Exploratory data analysis</span>">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>R para Ciência de Dados (2ª edição) foi escrito por Hadley Wickham, Mine Çetinkaya-Rundel, e Garrett Grolemund.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/cienciadedatos/pt-r4ds/edit/main/layers.qmd" class="toc-action"><i class="bi bi-github"></i>Editar essa página</a></li><li><a href="https://github.com/cienciadedatos/pt-r4ds/issues/new" class="toc-action"><i class="bi empty"></i>Criar uma issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Este livro foi contruído com <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>