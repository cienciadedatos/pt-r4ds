<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Hadley Wickham, Mine Çetinkaya-Rundel, e Garrett Grolemund">
<title>R para Ciência de Dados (2ª edição) - 20&nbsp; ✅ Planilhas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./databases.html" rel="next">
<link href="./import.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script><script defer="" data-domain="r4ds.hadley.nz" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./import.html">✅ Importar</a></li><li class="breadcrumb-item"><a href="./spreadsheets.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">✅ Planilhas</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R para Ciência de Dados (2ª edição)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/cienciadedatos/pt-r4ds/" title="Código fonte" class="quarto-navigation-tool px-1" aria-label="Código fonte"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo de leitor">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Boas-vindas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface-2e.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Prefácio da segunda edição</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Introdução</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./whole-game.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Visão geral</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">✅ Visualização de dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">✅ Fluxo de Trabalho: básico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">✅ Transformação de dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">✅ Fluxo de trabalho: estilo de código</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">✅ Organizando os dados (<em>data tidying</em>)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">✅ Fluxo de trabalho: scripts e projetos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">✅ Importação de dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">✅ Fluxo de trabalho: obtendo ajuda</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Visualizar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./layers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">✅ Camadas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EDA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Communication</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Transformar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logicals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">✅ Vetores lógicos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">✅ Números</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Strings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regexps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regular expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">✅ Fatores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datetimes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Dates and times</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missing-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">✅ Valores faltantes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./joins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Joins</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Importar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spreadsheets.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">✅ Planilhas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">✅ Bancos de dados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arrow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">✅ Arrow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rectangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Hierarchical data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./webscraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">✅ Raspagem de dados (<em>Web scraping</em>)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Programar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">✅ Funções</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Iteration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./base-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">✅ Um guia para o R base</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./communicate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">✅ Comunicar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">✅ Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto-formats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">✅ Formatos para Quarto</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Índice</h2>
   
  <ul>
<li><a href="#introdu%C3%A7%C3%A3o" id="toc-introdução" class="nav-link active" data-scroll-target="#introdu%C3%A7%C3%A3o"><span class="header-section-number">20.1</span> Introdução</a></li>
  <li>
<a href="#excel" id="toc-excel" class="nav-link" data-scroll-target="#excel"><span class="header-section-number">20.2</span> Excel</a>
  <ul class="collapse">
<li><a href="#pr%C3%A9-requisitos" id="toc-pré-requisitos" class="nav-link" data-scroll-target="#pr%C3%A9-requisitos"><span class="header-section-number">20.2.1</span> Pré-requisitos</a></li>
  <li><a href="#iniciando" id="toc-iniciando" class="nav-link" data-scroll-target="#iniciando"><span class="header-section-number">20.2.2</span> Iniciando</a></li>
  <li><a href="#sec-reading-spreadsheets-excel" id="toc-sec-reading-spreadsheets-excel" class="nav-link" data-scroll-target="#sec-reading-spreadsheets-excel"><span class="header-section-number">20.2.3</span> Importando arquivos do Excel</a></li>
  <li><a href="#importando-planilhas" id="toc-importando-planilhas" class="nav-link" data-scroll-target="#importando-planilhas"><span class="header-section-number">20.2.4</span> Importando planilhas</a></li>
  <li><a href="#importando-parte-de-uma-planilha" id="toc-importando-parte-de-uma-planilha" class="nav-link" data-scroll-target="#importando-parte-de-uma-planilha"><span class="header-section-number">20.2.5</span> Importando parte de uma planilha</a></li>
  <li><a href="#tipos-de-dados" id="toc-tipos-de-dados" class="nav-link" data-scroll-target="#tipos-de-dados"><span class="header-section-number">20.2.6</span> Tipos de dados</a></li>
  <li><a href="#sec-writing-to-excel" id="toc-sec-writing-to-excel" class="nav-link" data-scroll-target="#sec-writing-to-excel"><span class="header-section-number">20.2.7</span> Exportando para Excel</a></li>
  <li><a href="#sa%C3%ADdas-formatadas" id="toc-saídas-formatadas" class="nav-link" data-scroll-target="#sa%C3%ADdas-formatadas"><span class="header-section-number">20.2.8</span> Saídas formatadas</a></li>
  <li><a href="#exerc%C3%ADcios" id="toc-exercícios" class="nav-link" data-scroll-target="#exerc%C3%ADcios"><span class="header-section-number">20.2.9</span> Exercícios</a></li>
  </ul>
</li>
  <li>
<a href="#planilhas-google-google-sheets" id="toc-planilhas-google-google-sheets" class="nav-link" data-scroll-target="#planilhas-google-google-sheets"><span class="header-section-number">20.3</span> Planilhas Google (<em>Google Sheets</em>)</a>
  <ul class="collapse">
<li><a href="#pr%C3%A9-requisitos-1" id="toc-pré-requisitos-1" class="nav-link" data-scroll-target="#pr%C3%A9-requisitos-1"><span class="header-section-number">20.3.1</span> Pré-requisitos</a></li>
  <li><a href="#iniciando-1" id="toc-iniciando-1" class="nav-link" data-scroll-target="#iniciando-1"><span class="header-section-number">20.3.2</span> Iniciando</a></li>
  <li><a href="#importando-do-planilhas-google" id="toc-importando-do-planilhas-google" class="nav-link" data-scroll-target="#importando-do-planilhas-google"><span class="header-section-number">20.3.3</span> Importando do Planilhas Google</a></li>
  <li><a href="#exportando-para-o-planilhas-google" id="toc-exportando-para-o-planilhas-google" class="nav-link" data-scroll-target="#exportando-para-o-planilhas-google"><span class="header-section-number">20.3.4</span> Exportando para o Planilhas Google</a></li>
  <li><a href="#autentica%C3%A7%C3%A3o" id="toc-autenticação" class="nav-link" data-scroll-target="#autentica%C3%A7%C3%A3o"><span class="header-section-number">20.3.5</span> Autenticação</a></li>
  <li><a href="#exerc%C3%ADcios-1" id="toc-exercícios-1" class="nav-link" data-scroll-target="#exerc%C3%ADcios-1"><span class="header-section-number">20.3.6</span> Exercícios</a></li>
  </ul>
</li>
  <li><a href="#resumo" id="toc-resumo" class="nav-link" data-scroll-target="#resumo"><span class="header-section-number">20.4</span> Resumo</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/cienciadedatos/pt-r4ds/edit/main/spreadsheets.qmd" class="toc-action"><i class="bi bi-github"></i>Editar essa página</a></li><li><a href="https://github.com/cienciadedatos/pt-r4ds/issues/new" class="toc-action"><i class="bi empty"></i>Criar uma issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./import.html">✅ Importar</a></li><li class="breadcrumb-item"><a href="./spreadsheets.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">✅ Planilhas</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-import-spreadsheets" class="quarto-section-identifier"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">✅ Planilhas</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introdução" class="level2" data-number="20.1"><h2 data-number="20.1" class="anchored" data-anchor-id="introdução">
<span class="header-section-number">20.1</span> Introdução</h2>
<p>No <a href="data-import.html" class="quarto-xref"><span>Capítulo 7</span></a> você aprendeu sobre importação de dados de arquivos de texto como <code>.csv</code> e <code>.tsv</code>. Agora chegou a hora de aprender a extrair dados de planilhas, tanto do Excel quanto do Planilhas Google (<em>Google Sheets</em>). Para isto, usaremos muito do que você aprendeu no <a href="data-import.html" class="quarto-xref"><span>Capítulo 7</span></a>, mas discutiremos também considerações adicionais e complexidades presentes quando trabalhamos com dados vindos de planilhas.</p>
<p>Se você ou seus colaboradores estão usando planilhas para organizar dados, nós recomendamos fortemente a leitura do artigo “Organização de Dados em Planilhas (<em>Data Organization in Spreadsheets</em>) de Karl Broman e Kara Woo: <a href="https://doi.org/10.1080/00031305.2017.1375989" class="uri">https://doi.org/10.1080/00031305.2017.1375989</a>. As boas práticas presentes neste artigo evitarão dores de cabeça ao importar dados de planilhas para análise e visualização com o R.</p>
</section><section id="excel" class="level2" data-number="20.2"><h2 data-number="20.2" class="anchored" data-anchor-id="excel">
<span class="header-section-number">20.2</span> Excel</h2>
<p>O Microsoft Excel é um software muito utilizado onde os dados são organizados em planilhas (<em>worksheets</em>) dentro de arquivos Excel (<em>spreadsheet</em>).</p>
<section id="pré-requisitos" class="level3" data-number="20.2.1"><h3 data-number="20.2.1" class="anchored" data-anchor-id="pré-requisitos">
<span class="header-section-number">20.2.1</span> Pré-requisitos</h3>
<p>Nesta seção, você aprenderá como carregar dados de arquivos do Excel para o R com o pacote <strong>readxl</strong>. Este pacote faz parte dos componentes secundários (<em>non-core</em>) do tidyverse, portanto devemos carregá-lo explicitamente, apesar dele já ser instalado automaticamente quando você instala o tidyverse. Posteriormente, usaremos também o pacote writexl, que nos permite criar planilhas do Excel.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/writexl/">writexl</a></span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="iniciando" class="level3" data-number="20.2.2"><h3 data-number="20.2.2" class="anchored" data-anchor-id="iniciando">
<span class="header-section-number">20.2.2</span> Iniciando</h3>
<p>Muitas funções do readxl te permitem importar arquivos do Excel para o R:</p>
<ul>
<li>
<code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xls()</a></code> importa arquivos Excel que estejam no formato <code>xls</code>.</li>
<li>
<code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx()</a></code> importa arquivos Excel que estejam no formato <code>xlsx</code>.</li>
<li>
<code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> pode importar arquivos em ambos os formatos <code>xls</code> e <code>xlsx</code>. Ela identifica o formato baseado no tipo de arquivo de entrada.</li>
</ul>
<p>Estas funções possuem uma sintaxe similar às outras funções introduzidas anteriormente para importar outros tipos de arquivos, por exemplo: <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code>, <code><a href="https://readr.tidyverse.org/reference/read_table.html">read_table()</a></code>, etc. No restante deste capítulo focaremos no uso da função <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code>.</p>
</section><section id="sec-reading-spreadsheets-excel" class="level3" data-number="20.2.3"><h3 data-number="20.2.3" class="anchored" data-anchor-id="sec-reading-spreadsheets-excel">
<span class="header-section-number">20.2.3</span> Importando arquivos do Excel</h3>
<p>A <a href="#fig-students-excel" class="quarto-xref">Figura&nbsp;<span>20.1</span></a> mostra como é a planilha do Excel que iremos importar para o R. Esta planilha pode ser baixada em <a href="https://github.com/cienciadedatos/pt-r4ds/raw/traducao-pt-2ed/data/estudantes.xlsx" class="uri">https://github.com/cienciadedatos/pt-r4ds/raw/traducao-pt-2ed/data/estudantes.xlsx</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-students-excel" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Uma visão da planilha de estudantes no Excel. A planilha possui informações de 6 estudantes, seus IDs, nomes completos, comida favorita, plano alimentar e idade.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-students-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/import-spreadsheets-students.png" class="img-fluid figure-img" alt="Uma visão da planilha de estudantes no Excel. A planilha possui informações de 6 estudantes, seus IDs, nomes completos, comida favorita, plano alimentar e idade." width="1200">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-students-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.1: Planilha do Excel chamada estudantes.xlsx.
</figcaption></figure>
</div>
</div>
</div>
<p>O primeiro argumento da <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> é o caminho (<em>path</em>) do arquivo a ser importado.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">estudantes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/estudantes.xlsx"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> irá importar o arquivo como um <em>tibble</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">estudantes</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   `ID Estudante` `Nome Completo` comida.favorita    planoDeRefeição     IDADE</span></span>
<span><span class="co">#&gt;            &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;              &lt;chr&gt;               &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1              1 Igor Ribeiro    Iogurte de Morango Apenas Almoço       4.0  </span></span>
<span><span class="co">#&gt; 2              2 Fernanda Costa  Batatas Fritas     Apenas Almoço       5.0  </span></span>
<span><span class="co">#&gt; 3              3 Daniel Lima     N/A                Café da Manhã e Al… 7.0  </span></span>
<span><span class="co">#&gt; 4              4 Carla Oliveira  Anchovas           Apenas Almoço       &lt;NA&gt; </span></span>
<span><span class="co">#&gt; 5              5 Fábio Pêra      Pizza              Café da Manhã e Al… cinco</span></span>
<span><span class="co">#&gt; 6              6 Bruno Souza     Sorvete            Apenas Almoço       6.0</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Temos seis estudantes nos dados e cinco variáveis para cada estudante. Entretanto, existem algumas coisas que devemos abordar neste conjunto de dados:</p>
<ol type="1">
<li>
<p>Os nomes das colunas estão com formato inconsistente. Você pode fornecer nomes que seguem um formato consistente; nós recomendamos o <code>snake_case</code> usando o argumento <code>col_names</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="st">"data/estudantes.xlsx"</span>,</span>
<span>  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"estudante_id"</span>, <span class="st">"nome_completo"</span>, <span class="st">"comida_favorita"</span>, <span class="st">"refeicao_plano"</span>, <span class="st">"idade"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 7 × 5</span></span>
<span><span class="co">#&gt;   estudante_id nome_completo  comida_favorita    refeicao_plano         idade</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt;          &lt;chr&gt;              &lt;chr&gt;                  &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 ID Estudante Nome Completo  comida.favorita    planoDeRefeição        IDADE</span></span>
<span><span class="co">#&gt; 2 1.0          Igor Ribeiro   Iogurte de Morango Apenas Almoço          4.0  </span></span>
<span><span class="co">#&gt; 3 2.0          Fernanda Costa Batatas Fritas     Apenas Almoço          5.0  </span></span>
<span><span class="co">#&gt; 4 3.0          Daniel Lima    N/A                Café da Manhã e Almoço 7.0  </span></span>
<span><span class="co">#&gt; 5 4.0          Carla Oliveira Anchovas           Apenas Almoço          &lt;NA&gt; </span></span>
<span><span class="co">#&gt; 6 5.0          Fábio Pêra     Pizza              Café da Manhã e Almoço cinco</span></span>
<span><span class="co">#&gt; 7 6.0          Bruno Souza    Sorvete            Apenas Almoço          6.0</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Infelizmente, apenas isto não é o suficiente. Temos agora o nome das variáveis como gostaríamos, mas o que era anteriormente a linha de cabeçalho passou a aparecer nos dados como a primeira linha das observações. Você pode pular explicitamente esta linha usando o argumento <code>skip</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="st">"data/estudantes.xlsx"</span>,</span>
<span>  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"estudante_id"</span>, <span class="st">"nome_completo"</span>, <span class="st">"comida_favorita"</span>, <span class="st">"refeicao_plano"</span>, <span class="st">"idade"</span><span class="op">)</span>,</span>
<span>  skip <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   estudante_id nome_completo  comida_favorita    refeicao_plano         idade</span></span>
<span><span class="co">#&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;              &lt;chr&gt;                  &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1            1 Igor Ribeiro   Iogurte de Morango Apenas Almoço          4.0  </span></span>
<span><span class="co">#&gt; 2            2 Fernanda Costa Batatas Fritas     Apenas Almoço          5.0  </span></span>
<span><span class="co">#&gt; 3            3 Daniel Lima    N/A                Café da Manhã e Almoço 7.0  </span></span>
<span><span class="co">#&gt; 4            4 Carla Oliveira Anchovas           Apenas Almoço          &lt;NA&gt; </span></span>
<span><span class="co">#&gt; 5            5 Fábio Pêra     Pizza              Café da Manhã e Almoço cinco</span></span>
<span><span class="co">#&gt; 6            6 Bruno Souza    Sorvete            Apenas Almoço          6.0</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li>
<p>Na coluna <code>comida_favorita</code>, uma das observações está como <code>N/A</code>, que significa “não disponível” (<em>not available</em>) mas essa forma não é reconhecida como um valor não disponível (<code>NA</code>) do R (veja a diferença entre este <code>N/A</code> e o presente na <code>idade</code> do quarto estudante da lista). Você pode definir quais cadeias de caracteres (<em>strings</em>) devem ser reconhecidas pelo R como <code>NA</code> utilizando o argumento <code>na</code>. Por padrão, apenas <code>""</code> (<em>string</em> vazia, ou, quando trabalhando com uma planilha, uma célula vazia ou com a fórmula <code>=NA()</code>) é reconhecida como um <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="st">"data/estudantes.xlsx"</span>,</span>
<span>  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"estudante_id"</span>, <span class="st">"nome_completo"</span>, <span class="st">"comida_favorita"</span>, <span class="st">"refeicao_plano"</span>, <span class="st">"idade"</span><span class="op">)</span>,</span>
<span>  skip <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"N/A"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   estudante_id nome_completo  comida_favorita    refeicao_plano         idade</span></span>
<span><span class="co">#&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;              &lt;chr&gt;                  &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1            1 Igor Ribeiro   Iogurte de Morango Apenas Almoço          4.0  </span></span>
<span><span class="co">#&gt; 2            2 Fernanda Costa Batatas Fritas     Apenas Almoço          5.0  </span></span>
<span><span class="co">#&gt; 3            3 Daniel Lima    &lt;NA&gt;               Café da Manhã e Almoço 7.0  </span></span>
<span><span class="co">#&gt; 4            4 Carla Oliveira Anchovas           Apenas Almoço          &lt;NA&gt; </span></span>
<span><span class="co">#&gt; 5            5 Fábio Pêra     Pizza              Café da Manhã e Almoço cinco</span></span>
<span><span class="co">#&gt; 6            6 Bruno Souza    Sorvete            Apenas Almoço          6.0</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li>
<p>Um outro ponto que devemos observar é que a coluna <code>idade</code> é importada como uma variável texto, quando, na realidade, deveria ser numérica. Assim como na <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> e outras funções que importam dados de arquivos texto, você pode passar o argumento <code>col_types</code> para a <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> e especificar os tipos das colunas das variáveis que você está importanto. Porém, a sintaxe é um pouco diferente. Suas opções são: <code>"skip"</code>, <code>"guess"</code>, <code>"logical"</code>, <code>"numeric"</code>, <code>"date"</code>, <code>"text"</code> ou <code>"list"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="st">"data/estudantes.xlsx"</span>,</span>
<span>  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"estudante_id"</span>, <span class="st">"nome_completo"</span>, <span class="st">"comida_favorita"</span>, <span class="st">"refeicao_plano"</span>, <span class="st">"idade"</span><span class="op">)</span>,</span>
<span>  skip <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"N/A"</span><span class="op">)</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"numeric"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Expecting numeric in E6 / R6C5: got 'cinco'</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   estudante_id nome_completo  comida_favorita    refeicao_plano         idade</span></span>
<span><span class="co">#&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;              &lt;chr&gt;                  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1            1 Igor Ribeiro   Iogurte de Morango Apenas Almoço              4</span></span>
<span><span class="co">#&gt; 2            2 Fernanda Costa Batatas Fritas     Apenas Almoço              5</span></span>
<span><span class="co">#&gt; 3            3 Daniel Lima    &lt;NA&gt;               Café da Manhã e Almoço     7</span></span>
<span><span class="co">#&gt; 4            4 Carla Oliveira Anchovas           Apenas Almoço             NA</span></span>
<span><span class="co">#&gt; 5            5 Fábio Pêra     Pizza              Café da Manhã e Almoço    NA</span></span>
<span><span class="co">#&gt; 6            6 Bruno Souza    Sorvete            Apenas Almoço              6</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Porém, apenas isso também não produz o resultado desejado. Definindo que <code>idade</code> deve ser numérica, nós transformamos a célula com um valor não-numérico (aquela com valor <code>cinco</code>) em um <code>NA</code>. Neste caso, você deve importar <code>idade</code> como <code>"text"</code> e então fazer a mundança após os dados estarem carregados no R.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">estudantes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="st">"data/estudantes.xlsx"</span>,</span>
<span>  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"estudante_id"</span>, <span class="st">"nome_completo"</span>, <span class="st">"comida_favorita"</span>, <span class="st">"refeicao_plano"</span>, <span class="st">"idade"</span><span class="op">)</span>,</span>
<span>  skip <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"N/A"</span><span class="op">)</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">estudantes</span> <span class="op">&lt;-</span> <span class="va">estudantes</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    idade <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">idade</span> <span class="op">==</span> <span class="st">"cinco"</span>, <span class="st">"5"</span>, <span class="va">idade</span><span class="op">)</span>,</span>
<span>    idade <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="va">idade</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">estudantes</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   estudante_id nome_completo  comida_favorita    refeicao_plano         idade</span></span>
<span><span class="co">#&gt;          &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;              &lt;chr&gt;                  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1            1 Igor Ribeiro   Iogurte de Morango Apenas Almoço              4</span></span>
<span><span class="co">#&gt; 2            2 Fernanda Costa Batatas Fritas     Apenas Almoço              5</span></span>
<span><span class="co">#&gt; 3            3 Daniel Lima    &lt;NA&gt;               Café da Manhã e Almoço     7</span></span>
<span><span class="co">#&gt; 4            4 Carla Oliveira Anchovas           Apenas Almoço             NA</span></span>
<span><span class="co">#&gt; 5            5 Fábio Pêra     Pizza              Café da Manhã e Almoço     5</span></span>
<span><span class="co">#&gt; 6            6 Bruno Souza    Sorvete            Apenas Almoço              6</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
</ol>
<p>Foram necessários vários passos com tentativas e erros para importar os dados da maneira que precisávamos, e isto não é algo inesperado. A ciência de dados é um processo iterativo, e este processo de iteração pode ser ainda mais entediante quando importamos dados de planilhas se comparado a quando importamos dados de arquivos textos (dados retangulares) pois os humanos tendem a inserir dados nas planilhas e usá-las não apenas para armazenar os dados, mas também para compartilhamento e communicação.</p>
<p>Não há como saber exatamente como os dados serão importados até você carregá-los e dar uma olhada. Bem, na verdade há um jeito. Você pode abrir o arquivo no Excel e dar uma olhada. Se você for fazer isso, recomendamos fazer uma cópia do arquivo original e usar a outra cópia para navegar pelo arquivo, deixando a primeira inalterada para ser carregada pelo R. Isto certificará que você não irá sobreescrever acidentalmente nada na planilha enquanto a inspeciona. Você também não precisa ter medo de fazer o que fizemos aqui: Carregar o arquivo, dar uma olhada, fazer os ajustes no seu código, carregar novamente e repetir tudo até que esteja contente com o resultado.</p>
</section><section id="importando-planilhas" class="level3" data-number="20.2.4"><h3 data-number="20.2.4" class="anchored" data-anchor-id="importando-planilhas">
<span class="header-section-number">20.2.4</span> Importando planilhas</h3>
<p>Uma característica importante que distingue arquivos do Excel de arquivos texto, é a noção de várias planilhas (ou abas) dentro do mesmo arquivo. A <a href="#fig-penguins-islands" class="quarto-xref">Figura&nbsp;<span>20.2</span></a> mostra um arquivo Excel com várias planilhas. Os dados são do pacote <strong>palmerpenguins</strong>, e você pode fazer o download como um arquivo Excel em <a href="https://github.com/cienciadedatos/pt-r4ds/raw/traducao-pt-2ed/data/pinguins.xlsx" class="uri">https://github.com/cienciadedatos/pt-r4ds/raw/traducao-pt-2ed/data/pinguins.xlsx</a>. Cada planilha (ou aba) contém informações de pinguins de diferentes ilhas onde os dados foram coletados.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-penguins-islands" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Uma visão do arquivo de pinguins no Excel. O arquivo possui três planilhas: Ilha Torgersen, Ilha Biscoe e Ilha Dream.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-penguins-islands-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/import-spreadsheets-penguins-islands.png" class="img-fluid figure-img" alt="Uma visão do arquivo de pinguins no Excel. O arquivo possui três planilhas: Ilha Torgersen, Ilha Biscoe e Ilha Dream." width="1514">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-penguins-islands-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.2: Arquivo Excel chamado pinguins.xlsx contendo três planilhas (ou abas).
</figcaption></figure>
</div>
</div>
</div>
<p>Você pode importar uma única planilha usando o argumento <code>sheet</code> na função <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code>. Por padrão, o que utilizamos até agora, a primeira planilha é importada.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/pinguins.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Ilha Torgersen"</span><span class="op">)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; • `` -&gt; `...1`</span></span>
<span><span class="co">#&gt; # A tibble: 52 × 9</span></span>
<span><span class="co">#&gt;   ...1  especie           ilha      comprimento_bico profundidade_bico</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;             &lt;chr&gt;                &lt;dbl&gt;             &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 1     Pinguim-de-adélia Torgersen             39.1              18.7</span></span>
<span><span class="co">#&gt; 2 2     Pinguim-de-adélia Torgersen             39.5              17.4</span></span>
<span><span class="co">#&gt; 3 3     Pinguim-de-adélia Torgersen             40.3              18  </span></span>
<span><span class="co">#&gt; 4 4     Pinguim-de-adélia Torgersen             NA                NA  </span></span>
<span><span class="co">#&gt; 5 5     Pinguim-de-adélia Torgersen             36.7              19.3</span></span>
<span><span class="co">#&gt; 6 6     Pinguim-de-adélia Torgersen             39.3              20.6</span></span>
<span><span class="co">#&gt; # ℹ 46 more rows</span></span>
<span><span class="co">#&gt; # ℹ 4 more variables: comprimento_nadadeira &lt;dbl&gt;, massa_corporal &lt;dbl&gt;, …</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Algumas variáveis que parecem conter dados numéricos, são importadas como caracteres (texto) devido à cadeia de caractere <code>"NA"</code> não ser reconhecida como um verdadeiro <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pinguins_torgersen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/pinguins.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Ilha Torgersen"</span>, na <span class="op">=</span> <span class="st">"NA"</span><span class="op">)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; • `` -&gt; `...1`</span></span>
<span></span>
<span><span class="va">pinguins_torgersen</span></span>
<span><span class="co">#&gt; # A tibble: 52 × 9</span></span>
<span><span class="co">#&gt;   ...1  especie           ilha      comprimento_bico profundidade_bico</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;             &lt;chr&gt;                &lt;dbl&gt;             &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 1     Pinguim-de-adélia Torgersen             39.1              18.7</span></span>
<span><span class="co">#&gt; 2 2     Pinguim-de-adélia Torgersen             39.5              17.4</span></span>
<span><span class="co">#&gt; 3 3     Pinguim-de-adélia Torgersen             40.3              18  </span></span>
<span><span class="co">#&gt; 4 4     Pinguim-de-adélia Torgersen             NA                NA  </span></span>
<span><span class="co">#&gt; 5 5     Pinguim-de-adélia Torgersen             36.7              19.3</span></span>
<span><span class="co">#&gt; 6 6     Pinguim-de-adélia Torgersen             39.3              20.6</span></span>
<span><span class="co">#&gt; # ℹ 46 more rows</span></span>
<span><span class="co">#&gt; # ℹ 4 more variables: comprimento_nadadeira &lt;dbl&gt;, massa_corporal &lt;dbl&gt;, …</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternativamente, você pode usar <code><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets()</a></code> para obter informações de todas as planilhas presentes em um arquivo Excel, e então importar aquela(s) em que você está interessado.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span><span class="st">"data/pinguins.xlsx"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Ilha Biscoe"    "Ilha Dream"     "Ilha Torgersen"</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Assim que você souber o(s) nome(s) da(s) planilha(s), você pode importá-la(s) individualmente com <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pinguins_biscoe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/pinguins.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Ilha Biscoe"</span>, na <span class="op">=</span> <span class="st">"NA"</span><span class="op">)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; • `` -&gt; `...1`</span></span>
<span><span class="va">pinguins_dream</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/pinguins.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Ilha Dream"</span>, na <span class="op">=</span> <span class="st">"NA"</span><span class="op">)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; • `` -&gt; `...1`</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Neste caso, o conjunto de dados completo está espalhado entre três planilhas distintas no arquivo. Cada planilha tem o mesmo número de colunas, mas diferentes números de linhas.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pinguins_torgersen</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 52  9</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pinguins_biscoe</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 168   9</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pinguins_dream</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 124   9</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nós podemos uní-las usando <code><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pinguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">pinguins_torgersen</span>, <span class="va">pinguins_biscoe</span>, <span class="va">pinguins_dream</span><span class="op">)</span></span>
<span><span class="va">pinguins</span></span>
<span><span class="co">#&gt; # A tibble: 344 × 9</span></span>
<span><span class="co">#&gt;   ...1  especie           ilha      comprimento_bico profundidade_bico</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;             &lt;chr&gt;                &lt;dbl&gt;             &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 1     Pinguim-de-adélia Torgersen             39.1              18.7</span></span>
<span><span class="co">#&gt; 2 2     Pinguim-de-adélia Torgersen             39.5              17.4</span></span>
<span><span class="co">#&gt; 3 3     Pinguim-de-adélia Torgersen             40.3              18  </span></span>
<span><span class="co">#&gt; 4 4     Pinguim-de-adélia Torgersen             NA                NA  </span></span>
<span><span class="co">#&gt; 5 5     Pinguim-de-adélia Torgersen             36.7              19.3</span></span>
<span><span class="co">#&gt; 6 6     Pinguim-de-adélia Torgersen             39.3              20.6</span></span>
<span><span class="co">#&gt; # ℹ 338 more rows</span></span>
<span><span class="co">#&gt; # ℹ 4 more variables: comprimento_nadadeira &lt;dbl&gt;, massa_corporal &lt;dbl&gt;, …</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>No <a href="iteration.html" class="quarto-xref"><span>Capítulo 26</span></a> falaremos sobre outras maneiras de fazer este tipo de coisa sem repetir código.</p>
</section><section id="importando-parte-de-uma-planilha" class="level3" data-number="20.2.5"><h3 data-number="20.2.5" class="anchored" data-anchor-id="importando-parte-de-uma-planilha">
<span class="header-section-number">20.2.5</span> Importando parte de uma planilha</h3>
<p>Uma vez que muitas pessoas usam arquivos do Excel tanto pra apresentação quanto para armazenamento dos dados, é muito comum encontrarmos células em uma planilha que não fazem parte dos dados que você quer importar para o R. A <a href="#fig-deaths-excel" class="quarto-xref">Figura&nbsp;<span>20.3</span></a> mostra um exemplo: no centro da planilha temos algo que se parece com um <em>data frame</em>, mas existem estranhos textos acima e abaixo dos dados.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-deaths-excel" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Uma visão da planilha 'deaths' no Excel. A planilha possui quatro linhas no topo contém informações extras aos dados; o texto 'Por razôes de consistência no *layout* dos dados, algo que é realmente belo, continuarei a fazer notas por aqui.' está espalhado pelas quatro linhas. Então, há um *data frame* que inclui informações sobre os óbitos de 10 pessoas famosas, incluindo seus nomes, profissões, idades, se tinham filhos ou não, data de nascimento e óbito. Na parte de baixo, existem outras 4 linhas extras aos dados; no texto 'Isto tem sido realmente divertido, mas estamos nos desconectando agora!' está espalhado por estas quatro linhas finais.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-deaths-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/import-spreadsheets-deaths.png" class="img-fluid figure-img" alt="Uma visão da planilha 'deaths' no Excel. A planilha possui quatro linhas no topo contém informações extras aos dados; o texto 'Por razôes de consistência no *layout* dos dados, algo que é realmente belo, continuarei a fazer notas por aqui.' está espalhado pelas quatro linhas. Então, há um *data frame* que inclui informações sobre os óbitos de 10 pessoas famosas, incluindo seus nomes, profissões, idades, se tinham filhos ou não, data de nascimento e óbito. Na parte de baixo, existem outras 4 linhas extras aos dados; no texto 'Isto tem sido realmente divertido, mas estamos nos desconectando agora!' está espalhado por estas quatro linhas finais." width="1614">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-deaths-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.3: Arquivo do Excel chamado deaths.xlsx
</figcaption></figure>
</div>
</div>
</div>
<p>Esta planilha é um dos exemplos fornecidos com o pacote readxl. Você pode usar a função <code><a href="https://readxl.tidyverse.org/reference/readxl_example.html">readxl_example()</a></code> para localizar esta planilha no diretório em que o pacote foi instalado em seu computador. Esta função retorna o caminho para o arquivo do Excel, que você pode importar usando a <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> como de costume.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">obitos_caminho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"deaths.xlsx"</span><span class="op">)</span></span>
<span><span class="va">obitos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">obitos_caminho</span><span class="op">)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; • `` -&gt; `...2`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...3`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...4`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...5`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...6`</span></span>
<span><span class="va">obitos</span></span>
<span><span class="co">#&gt; # A tibble: 18 × 6</span></span>
<span><span class="co">#&gt;   `Lots of people`    ...2       ...3  ...4     ...5          ...6           </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;               &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;          </span></span>
<span><span class="co">#&gt; 1 simply cannot resi… &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          some notes     </span></span>
<span><span class="co">#&gt; 2 at                  the        top   &lt;NA&gt;     of            their spreadsh…</span></span>
<span><span class="co">#&gt; 3 or                  merging    &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          cells          </span></span>
<span><span class="co">#&gt; 4 Name                Profession Age   Has kids Date of birth Date of death  </span></span>
<span><span class="co">#&gt; 5 David Bowie         musician   69    TRUE     17175         42379          </span></span>
<span><span class="co">#&gt; 6 Carrie Fisher       actor      60    TRUE     20749         42731          </span></span>
<span><span class="co">#&gt; # ℹ 12 more rows</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As primeiras três linhas e as quatro linhas no final, não fazem parte do <em>data frame</em>. É possível eliminar estas linhas extras usando os argumentos <code>skip</code> e <code>n_max</code>, mas recomendamos utilizar intervalos (<em>range</em>) de células. No Excel, a célula superior esquerda é a <code>A1</code>. Conforme você se move pelas colunas para a direita, o título da célula segue a sequência do alfabeto, ou seja: <code>B1</code>, <code>C1</code>, etc. E conforme você se move para baixo na coluna, o número da célula aumenta, ex: <code>A2</code>, <code>A3</code>, etc.</p>
<p>Aqui, os dados que desejamos importar começam na célula <code>A5</code> e terminam na célula <code>F15</code>. Na notação da planilha, temos <code>A5:F15</code>, que fornecemos para o argumento <code>range</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">obitos_caminho</span>, range <span class="op">=</span> <span class="st">"A5:F15"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 6</span></span>
<span><span class="co">#&gt;   Name          Profession   Age `Has kids` `Date of birth`    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt; &lt;lgl&gt;      &lt;dttm&gt;             </span></span>
<span><span class="co">#&gt; 1 David Bowie   musician      69 TRUE       1947-01-08 00:00:00</span></span>
<span><span class="co">#&gt; 2 Carrie Fisher actor         60 TRUE       1956-10-21 00:00:00</span></span>
<span><span class="co">#&gt; 3 Chuck Berry   musician      90 TRUE       1926-10-18 00:00:00</span></span>
<span><span class="co">#&gt; 4 Bill Paxton   actor         61 TRUE       1955-05-17 00:00:00</span></span>
<span><span class="co">#&gt; 5 Prince        musician      57 TRUE       1958-06-07 00:00:00</span></span>
<span><span class="co">#&gt; 6 Alan Rickman  actor         69 FALSE      1946-02-21 00:00:00</span></span>
<span><span class="co">#&gt; # ℹ 4 more rows</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: `Date of death` &lt;dttm&gt;</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="tipos-de-dados" class="level3" data-number="20.2.6"><h3 data-number="20.2.6" class="anchored" data-anchor-id="tipos-de-dados">
<span class="header-section-number">20.2.6</span> Tipos de dados</h3>
<p>Em arquivos CSV, todos os valores são <em>strings”. Isto não é particularmente verdadeiro para os dados, mas é simples: tudo é uma</em> string”.</p>
<p>Os dados intrínsecos nas planilhas Excel são mais complexos. Uma célula pode conter uma dessas quatro coisas:</p>
<ul>
<li><p>Um booleano, como <code>TRUE</code>, <code>FALSE</code>, ou <code>NA</code>.</p></li>
<li><p>Um número, como “10” ou “10.5”.</p></li>
<li><p>Uma data/horário (<em>datetime</em>), que pode conter algo como “11/1/21” ou “11/1/21 3:00 PM”.</p></li>
<li><p>Um texto (<em>string</em>), como “dez”.</p></li>
</ul>
<p>Quando trabalhamos com dados de planilhas, é importante ter em mente que os dados intrínsecos podem ser muito diferentes daquilo que vemos em uma célula. Por exemplo, o Excel não tem a noção de ‘inteiro’ (<em>integer</em>). Todos os números são armazenados como ponto flutuante (<em>floating points</em>), mas você pode optar em mostrar os dados de uma forma personalizada de casas decimais. Da mesma maneira, datas são na verdade armazenadas como números, especificamente número de segundos desde 1º de Janeiro de 1970. Você pode personalizar como você quer mostrar as datas no Excel aplicando formatações. Para confundir ainda mais, também é possível ter algo que se parece com um número, mas é na verdade uma <em>string</em> (por exemplo: , digite <code>'10</code> em uma célula no Excel).</p>
<p>Estas diferenças em como os dados intrínsecos são armazenados vs.&nbsp;como eles são mostrados na tela podem causar surpresas quando os dados são importados para o R. Por padrão, readxl tentará adivinhar o tipo de dado de uma determinada coluna. Um fluxo de trabalho recomendado é deixar o readxl adivinhar os tipos das colunas, confirmar se você está contente com os tipos sugeridos, e caso não estiver, importar novamente especificando o argumento <code>col_types</code> como mostrado na <a href="#sec-reading-spreadsheets-excel" class="quarto-xref"><span>Seção 20.2.3</span></a>.</p>
<p>Outro desafio é quando você tem uma coluna na planilha do Excel que tem uma mistura de diferentes tipos: algumas células são numéricas, outras contém texto, outras contém datas. Quando importamos esses dados para o R, o readxl deve tomar algumas decisões. Nestes casos, você pode definir o tipo para esta coluna como <code>"list"</code>, o qual importará a coluna como uma lista de vetores de tamanho 1, onde o tipo de cada elemento do vetor é sugerido.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Algumas vezes os dados são armazenados de forma mais exótica, como cores de fundo da célula, ou com texto em negrito ou não. Nestes casos, você pode achar útil o pacote <a href="https://nacnudus.github.io/tidyxl/">tidyxl</a>. Veja <a href="https://nacnudus.github.io/spreadsheet-munging-strategies/" class="uri">https://nacnudus.github.io/spreadsheet-munging-strategies/</a> para mais estratégias de trabalho com dados não tabulares vindos do Excel.</p>
</div>
</div>
</div>
</section><section id="sec-writing-to-excel" class="level3" data-number="20.2.7"><h3 data-number="20.2.7" class="anchored" data-anchor-id="sec-writing-to-excel">
<span class="header-section-number">20.2.7</span> Exportando para Excel</h3>
<p>Vamos criar um pequeno conjunto de dados (<em>tibble</em>) que iremos exportar. Note que <code>item</code> é um fator (<em>factor</em>) e <code>quantidade</code> é um inteiro (<em>integer</em>).</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">doces_vendas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  item     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"brownie"</span>, <span class="st">"cupcake"</span>, <span class="st">"cookie"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  quantidade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">doces_vendas</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span><span class="co">#&gt;   item    quantidade</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 brownie         10</span></span>
<span><span class="co">#&gt; 2 cupcake          5</span></span>
<span><span class="co">#&gt; 3 cookie           8</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Você pode gravar estes dados em disco como um arquivo do Excel usando a função <code><a href="https://docs.ropensci.org/writexl/reference/write_xlsx.html">write_xlsx()</a></code> do pacote <a href="https://docs.ropensci.org/writexl/">writexl package</a>:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/writexl/reference/write_xlsx.html">write_xlsx</a></span><span class="op">(</span><span class="va">doces_vendas</span>, path <span class="op">=</span> <span class="st">"data/doces-vendas.xlsx"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A <a href="#fig-bake-sale-excel" class="quarto-xref">Figura&nbsp;<span>20.4</span></a> mostra como os dados aparecem no Excel. Note que os nomes das colunas também aparecem em negrito. Isto pode ser modificado definindo como <code>FALSE</code> os argumentos <code>col_names</code> e <code>format_headers</code>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-bake-sale-excel" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Conjunto de dados doces_vendas criado anteriormente mostrados no Excel.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bake-sale-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/import-spreadsheets-bake-sale.png" class="img-fluid figure-img" alt="Conjunto de dados doces_vendas criado anteriormente mostrados no Excel." width="917">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bake-sale-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.4: Arquivo Excel chamado doces-vendas.xlsx.
</figcaption></figure>
</div>
</div>
</div>
<p>Assim como acontece quando importamos dados de um CSV, as informações sobre os tipos de dados são perdidas quando importamos os dados novamente. Isto torna os arquivos do Excel uma fonte não confiável para armazenar resultados parciais. Para alternativas, veja <a href="data-import.html#sec-writing-to-a-file" class="quarto-xref"><span>Seção 7.5</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/doces-vendas.xlsx"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span><span class="co">#&gt;   item    quantidade</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 brownie         10</span></span>
<span><span class="co">#&gt; 2 cupcake          5</span></span>
<span><span class="co">#&gt; 3 cookie           8</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="saídas-formatadas" class="level3" data-number="20.2.8"><h3 data-number="20.2.8" class="anchored" data-anchor-id="saídas-formatadas">
<span class="header-section-number">20.2.8</span> Saídas formatadas</h3>
<p>O pacote writexl é uma solução simplificada para criar uma simples planilha do Excel, mas se você estiver interessado em características adicionais como escrever em uma planilha dentro de um arquivo e estilizá-la, você pode querer utilizar o pacote <a href="https://ycphs.github.io/openxlsx">openxlsx</a>. Não entraremos nos detalhes deste pacote aqui, mas recomendamos ler <a href="https://ycphs.github.io/openxlsx/articles/Formatting.html" class="uri">https://ycphs.github.io/openxlsx/articles/Formatting.html</a> para uma extensa discussão sobre outras funcionalidades de formatação de dados do R para o Excel usando o openxlsx.</p>
<p>Observe que este pacote não faz parte do tidyverse, portanto as funções e fluxos de trabalho podem não ser familiares. Por exemplo, os nomes das funções usam <em>camelCase</em>, várias funções não podem compor um <em>pipeline</em>, e os argumentos tendem a seguir ordens diferentes daquelas do tidyverse. Entretanto, tudo bem. Conforme seu aprendizado e uso do R expandem para além deste livro, você encontrará vários outros estilos em diversos pacotes disponíveis para atingir seus objetivos específicos no R. Uma boa forma de se familiarizar com o estilo de código em um novo pacote é executar alguns exemplos fornecidos na documentação das funções, sentir a sintaxe e formatos de saída, assim como ler qualquer <em>vignette</em> que acompanha o pacote.</p>
</section><section id="exercícios" class="level3" data-number="20.2.9"><h3 data-number="20.2.9" class="anchored" data-anchor-id="exercícios">
<span class="header-section-number">20.2.9</span> Exercícios</h3>
<ol type="1">
<li>
<p>Em um arquivo do Excel, crie o seguinte conjunto de dados e salve como <code>pesquisa.xlsx</code>. Alternativamente, você pode baixar <a href="https://github.com/cienciadedatos/pt-r4ds/raw/traducao-pt-2ed/data/pesquisa.xlsx">aqui</a> como arquivo do Excel.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="screenshots/import-spreadsheets-survey.png" class="img-fluid figure-img" alt="Uma planilha com 2 colunas (pesquisa_id e n_animais_estimacao) e 7 linhas. A primeira linha possui os nomes das colunas. A coluna pesquisa_id possui números de 1 até 6. A coluna n_animais_estimacao, possui valores entre 0 e 2, contendo dois valores em texto (N/A e two)." width="263"></p>
</figure>
</div>
</div>
</div>
<p>Depois, importe para o R tendo <code>pesquisa_id</code> como uma variável texto e <code>n_animais_estimacao</code> como uma variável numérica.</p>
<div class="cell">
<pre><code>#&gt; # A tibble: 6 × 2
#&gt;   pesquisa_id n_animais_estimacao
#&gt;   &lt;chr&gt;                     &lt;dbl&gt;
#&gt; 1 1                             0
#&gt; 2 2                             1
#&gt; 3 3                            NA
#&gt; 4 4                             2
#&gt; 5 5                             2
#&gt; 6 6                            NA</code></pre>
</div>
</li>
<li>
<p>Em outro arquivo do Excel, crie o seguinte conjunto de dados e salve como <code>lista.xlsx</code>. Alternativamente, você pode baixar <a href="https://github.com/cienciadedatos/pt-r4ds/raw/traducao-pt-2ed/data/lista.xlsx">aqui</a> como arquivo do Excel.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="screenshots/import-spreadsheets-roster.png" class="img-fluid figure-img" alt="Uma planilha com 3 colunas (grupo, subgrupo, e id) e 12 linhas. A coluna grupo contém dois valores: 1 (combinando 7 linhas juntas) e 2 (combinando 5 linhas juntas). A coluna subgrupo tem quatro valores: A (combinando 3 linhas juntas), B (combinando 4 linhas juntas), A (combinando 2 linhas juntas), e B (combinando 3 linhas juntas). A coluna id tem doze valores, números de 1 até 12." width="255"></p>
</figure>
</div>
</div>
</div>
<p>Depois, importe-o para o R. O conjunto de dados resultante deve ser nomeado como <code>lista</code> e deve se parecer com o que é mostrado a seguir.</p>
<div class="cell">
<pre><code>#&gt; # A tibble: 12 × 3
#&gt;    grupo subgrupo    id
#&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
#&gt;  1     1 A            1
#&gt;  2     1 A            2
#&gt;  3     1 A            3
#&gt;  4     1 B            4
#&gt;  5     1 B            5
#&gt;  6     1 B            6
#&gt;  7     1 B            7
#&gt;  8     2 A            8
#&gt;  9     2 A            9
#&gt; 10     2 B           10
#&gt; 11     2 B           11
#&gt; 12     2 B           12</code></pre>
</div>
</li>
<li>
<p>Em um novo arquivo do Excel, crie o seguinte conjunto de dados e salve como <code>vendas.xlsx</code>. Alternativamente, você pode baixar <a href="https://github.com/cienciadedatos/pt-r4ds/raw/traducao-pt-2ed/data/vendas.xlsx">aqui</a> como arquivo do Excel.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="screenshots/import-spreadsheets-sales.png" class="img-fluid figure-img" alt="Uma planilha com 2 colunas e 13 linhas. As primeiras duas linhas tem um texto contendo informações sobre a planilha. A linha 1 diz &quot;Este arquivo contém informações de vendas&quot;. A linha 2 diz &quot;Dados estão organizados por nome da marca e para cada marca, temos um número ID para cada item vendido e quantos foram vendidos.&quot;. Depois existem duas linhas em branco seguidas por 9 linhas de dados." width="317"></p>
</figure>
</div>
</div>
</div>
<p>a. Importar <code>vendas.xlsx</code> e salvar como <code>vendas</code>. O conjunto de dados deve se parecer com o que é mostrado a seguir, com <code>id</code> e <code>n</code> como nomes das colunas e com 9 linhas.</p>
<div class="cell">
<pre><code>#&gt; # A tibble: 9 × 2
#&gt;   id      n    
#&gt;   &lt;chr&gt;   &lt;chr&gt;
#&gt; 1 Marca 1 n    
#&gt; 2 1234    8    
#&gt; 3 8721    2    
#&gt; 4 1822    3    
#&gt; 5 Marca 2 n    
#&gt; 6 3333    1    
#&gt; 7 2156    3    
#&gt; 8 3987    6    
#&gt; 9 3216    5</code></pre>
</div>
<p>b. Modifique <code>vendas</code> de forma a ficar organizado (<em>tidy</em>) com três colunas (<code>marca</code>, <code>id</code>, e <code>n</code>) e 7 linhas de dados. Note que <code>id</code> e <code>n</code> são numéricas, <code>marca</code> é uma variável texto (ou caractere).</p>
<div class="cell">
<pre><code>#&gt; # A tibble: 7 × 3
#&gt;   marca      id     n
#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 Marca 1  1234     8
#&gt; 2 Marca 1  8721     2
#&gt; 3 Marca 1  1822     3
#&gt; 4 Marca 2  3333     1
#&gt; 5 Marca 2  2156     3
#&gt; 6 Marca 2  3987     6
#&gt; 7 Marca 2  3216     5</code></pre>
</div>
</li>
<li><p>Recrie o conjunto de dados <code>doces_vendas</code>, exporte para um arquivo do Excel usando a função <code>write.xlsx()</code> do pacote openxlsx.</p></li>
<li><p>No <a href="data-import.html" class="quarto-xref"><span>Capítulo 7</span></a> você aprendeu sobre a função <code><a href="https://sfirke.github.io/janitor/reference/clean_names.html">janitor::clean_names()</a></code> para transformar os nomes das colunas em <em>snake case</em>. Importe o arquivo <code>estudantes.xlsx</code> que foi introduzido anteriormente nesta seção e use a função para “limpar” os nomes das colunas.</p></li>
<li><p>O que acontece se você tentar importar um arquivo com a extensão <code>.xlsx</code> com <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xls()</a></code>?</p></li>
</ol></section></section><section id="planilhas-google-google-sheets" class="level2" data-number="20.3"><h2 data-number="20.3" class="anchored" data-anchor-id="planilhas-google-google-sheets">
<span class="header-section-number">20.3</span> Planilhas Google (<em>Google Sheets</em>)</h2>
<p>O Planilhas Google (<em>Google Sheets</em>) é um outro programa de planilha amplamente utilizado. É gratuito e acessado via navegador (<em>web-based</em>). Assim como o Excel, no Planilhas Google, os dados são armazenados em planilhas dentro de um arquivo.</p>
<section id="pré-requisitos-1" class="level3" data-number="20.3.1"><h3 data-number="20.3.1" class="anchored" data-anchor-id="pré-requisitos-1">
<span class="header-section-number">20.3.1</span> Pré-requisitos</h3>
<p>Esta seção também será focada em planilhas, mas desta vez você irá carregar os dados do Planilhas Google com o pacote <strong>googlesheets4</strong>. Este pacote também faz parte dos componentes secundários (<em>non-core</em>) do tidyverse, portanto devemos carregá-lo explicitamente.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://googlesheets4.tidyverse.org">googlesheets4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Uma breve nota sobre o nome do pacote: googlesheets4 usa a versão 4 da <a href="https://developers.google.com/sheets/api/">API do Planilhas Google</a> para fornecer uma interface do Planilhas Google para o R, por isso este nome.</p>
</section><section id="iniciando-1" class="level3" data-number="20.3.2"><h3 data-number="20.3.2" class="anchored" data-anchor-id="iniciando-1">
<span class="header-section-number">20.3.2</span> Iniciando</h3>
<p>A principal função do pacote googlesheets4 é a <code><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet()</a></code>, a qual importa uma planilha do Google a partir de uma URL ou id do arquivo. Esta função também pode ser chamada pelo nome de <code><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">range_read()</a></code>.</p>
<p>Você também pode criar uma nova planilha com a <code><a href="https://googlesheets4.tidyverse.org/reference/gs4_create.html">gs4_create()</a></code> ou escrever em uma planilha já existente com a <code><a href="https://googlesheets4.tidyverse.org/reference/sheet_write.html">sheet_write()</a></code> e semelhantes.</p>
<p>Nesta seção trabalharemos com os mesmos conjuntos de dados utilizados na seção sobre arquivos do Excel para destacar semelhanças e diferenças entre o fluxo de trabalho de importação de dados do Excel e do Planilhas Google. Os pacotes readxl e googlesheets4 foram desenhados para terem funcionalidades semelhantes ao pacote readr, o qual fornece a função <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> que você viu no <a href="data-import.html" class="quarto-xref"><span>Capítulo 7</span></a>. Existem muitas tarefas que podem ser realizadas apenas trocando <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> por <code><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet()</a></code>. Entretanto, você verá que o Excel e o Planilhas Google não se comportam extamente da mesma maneira, por isso, algumas chamadas de funções podem ser diferentes.</p>
</section><section id="importando-do-planilhas-google" class="level3" data-number="20.3.3"><h3 data-number="20.3.3" class="anchored" data-anchor-id="importando-do-planilhas-google">
<span class="header-section-number">20.3.3</span> Importando do Planilhas Google</h3>
<p>A <a href="#fig-students-googlesheets" class="quarto-xref">Figura&nbsp;<span>20.5</span></a> mostra como é a planilha do Google que iremos importar para o R. Este é o mesmo conjunto de dados da <a href="#fig-students-excel" class="quarto-xref">Figura&nbsp;<span>20.1</span></a>, exceto que está armazenado no Planilhas Google ao invés do Excel.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-students-googlesheets" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Uma visão da planilha estudantes no Planilhas Google. A planilha contém informações de 6 estudantes, seus IDs, nomes completos, comida favorita, plano alimentar e idade.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-students-googlesheets-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/import-googlesheets-students.png" class="img-fluid figure-img" alt="Uma visão da planilha estudantes no Planilhas Google. A planilha contém informações de 6 estudantes, seus IDs, nomes completos, comida favorita, plano alimentar e idade." width="986">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-students-googlesheets-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20.5: Planilha do Google chamada estudantes em uma janela do navegador.
</figcaption></figure>
</div>
</div>
</div>
<p>O primeiro argumento da <code><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet()</a></code> é a URL do arquivo a ser importado, e a função retorna um tibble:<br><a href="https://docs.google.com/spreadsheets/d/1V1nPp1tzOuutXFLb3G9Eyxi3qxeEhnOXUzL5_BcCQ0w" class="uri">https://docs.google.com/spreadsheets/d/1V1nPp1tzOuutXFLb3G9Eyxi3qxeEhnOXUzL5_BcCQ0w</a>. Estas URLs não são fáceis de se trabalhar, portanto frequentemente você irá preferir identificar uma planilha através do seu ID.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/gs4_deauth.html">gs4_deauth</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">estudantes_planilha_id</span> <span class="op">&lt;-</span> <span class="st">"1V1nPp1tzOuutXFLb3G9Eyxi3qxeEhnOXUzL5_BcCQ0w"</span></span>
<span><span class="va">estudantes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">estudantes_planilha_id</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Reading from students.</span></span>
<span><span class="co">#&gt; ✔ Range Sheet1.</span></span>
<span><span class="va">estudantes</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   `Student ID` `Full Name`      favourite.food     mealPlan            AGE   </span></span>
<span><span class="co">#&gt;          &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;              &lt;chr&gt;               &lt;list&gt;</span></span>
<span><span class="co">#&gt; 1            1 Sunil Huffmann   Strawberry yoghurt Lunch only          &lt;dbl&gt; </span></span>
<span><span class="co">#&gt; 2            2 Barclay Lynn     French fries       Lunch only          &lt;dbl&gt; </span></span>
<span><span class="co">#&gt; 3            3 Jayendra Lyne    N/A                Breakfast and lunch &lt;dbl&gt; </span></span>
<span><span class="co">#&gt; 4            4 Leon Rossini     Anchovies          Lunch only          &lt;NULL&gt;</span></span>
<span><span class="co">#&gt; 5            5 Chidiegwu Dunkel Pizza              Breakfast and lunch &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 6            6 Güvenç Attila    Ice cream          Lunch only          &lt;dbl&gt;</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Assim como fizemos na <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code>, você pode fornecer nomes para as colunas, <em>strings</em> de valores não disponíveis (NA) e os tipos das colunas para a <code><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">estudantes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet</a></span><span class="op">(</span></span>
<span>  <span class="va">estudantes_planilha_id</span>,</span>
<span>  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"estudante_id"</span>, <span class="st">"nome_completo"</span>, <span class="st">"comida_favorita"</span>, <span class="st">"refeicao_plano"</span>, <span class="st">"idade"</span><span class="op">)</span>,</span>
<span>  skip <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"N/A"</span><span class="op">)</span>,</span>
<span>  col_types <span class="op">=</span> <span class="st">"dcccc"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Reading from students.</span></span>
<span><span class="co">#&gt; ✔ Range 2:10000000.</span></span>
<span></span>
<span><span class="va">estudantes</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   estudante_id nome_completo    comida_favorita    refeicao_plano      idade</span></span>
<span><span class="co">#&gt;          &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;              &lt;chr&gt;               &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1            1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    </span></span>
<span><span class="co">#&gt; 2            2 Barclay Lynn     French fries       Lunch only          5    </span></span>
<span><span class="co">#&gt; 3            3 Jayendra Lyne    &lt;NA&gt;               Breakfast and lunch 7    </span></span>
<span><span class="co">#&gt; 4            4 Leon Rossini     Anchovies          Lunch only          &lt;NA&gt; </span></span>
<span><span class="co">#&gt; 5            5 Chidiegwu Dunkel Pizza              Breakfast and lunch five </span></span>
<span><span class="co">#&gt; 6            6 Güvenç Attila    Ice cream          Lunch only          6</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note que definimos os tipos das colunas de uma forma um pouco diferente aqui, usando códigos abreviados. Por exemplo, “dcccc” significa “<em>double</em>, <em>character</em>, <em>character</em>, <em>character</em>, <em>character</em>”.</p>
<p>Também é possível importar planilhas individuais do Planilhas Google. Para importar somente a planilha “Ilha Torgersen” da <a href="https://pos.it/r4ds-penguins">Planilha Pinguins do Planilhas Google</a>:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pinguins_planilha_id</span> <span class="op">&lt;-</span> <span class="st">"1aFu8lnD_g0yjF5O-K6SFgSEWiHPpgvFCF0NY9D6LXnY"</span></span>
<span><span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">pinguins_planilha_id</span>, sheet <span class="op">=</span> <span class="st">"Torgersen Island"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Reading from penguins.</span></span>
<span><span class="co">#&gt; ✔ Range ''Torgersen Island''.</span></span>
<span><span class="co">#&gt; # A tibble: 52 × 8</span></span>
<span><span class="co">#&gt;   species island    bill_length_mm bill_depth_mm flipper_length_mm</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;list&gt;         &lt;list&gt;        &lt;list&gt;           </span></span>
<span><span class="co">#&gt; 1 Adelie  Torgersen &lt;dbl [1]&gt;      &lt;dbl [1]&gt;     &lt;dbl [1]&gt;        </span></span>
<span><span class="co">#&gt; 2 Adelie  Torgersen &lt;dbl [1]&gt;      &lt;dbl [1]&gt;     &lt;dbl [1]&gt;        </span></span>
<span><span class="co">#&gt; 3 Adelie  Torgersen &lt;dbl [1]&gt;      &lt;dbl [1]&gt;     &lt;dbl [1]&gt;        </span></span>
<span><span class="co">#&gt; 4 Adelie  Torgersen &lt;chr [1]&gt;      &lt;chr [1]&gt;     &lt;chr [1]&gt;        </span></span>
<span><span class="co">#&gt; 5 Adelie  Torgersen &lt;dbl [1]&gt;      &lt;dbl [1]&gt;     &lt;dbl [1]&gt;        </span></span>
<span><span class="co">#&gt; 6 Adelie  Torgersen &lt;dbl [1]&gt;      &lt;dbl [1]&gt;     &lt;dbl [1]&gt;        </span></span>
<span><span class="co">#&gt; # ℹ 46 more rows</span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: body_mass_g &lt;list&gt;, sex &lt;chr&gt;, year &lt;dbl&gt;</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Você pode obter todos os nomes de planilhas de dentro de um arquivo do Planilhas Google com <code><a href="https://googlesheets4.tidyverse.org/reference/sheet_properties.html">sheet_names()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/sheet_properties.html">sheet_names</a></span><span class="op">(</span><span class="va">pinguins_planilha_id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Torgersen Island" "Biscoe Island"    "Dream Island"</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finalmente, assim como na <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code>, podemos importar um intervalo de uma planilha definindo o argumento <code>range</code> na função <code><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet()</a></code>. Observe que também estamos utilizando a função <code><a href="https://googlesheets4.tidyverse.org/reference/gs4_examples.html">gs4_example()</a></code> para localizar a planilha de exemplo que vem junto com o pacote googlesheets4.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">obitos_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/gs4_examples.html">gs4_example</a></span><span class="op">(</span><span class="st">"deaths"</span><span class="op">)</span></span>
<span><span class="va">obitos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">obitos_url</span>, range <span class="op">=</span> <span class="st">"A5:F15"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Reading from deaths.</span></span>
<span><span class="co">#&gt; ✔ Range A5:F15.</span></span>
<span><span class="va">obitos</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 6</span></span>
<span><span class="co">#&gt;   Name          Profession   Age `Has kids` `Date of birth`    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt; &lt;lgl&gt;      &lt;dttm&gt;             </span></span>
<span><span class="co">#&gt; 1 David Bowie   musician      69 TRUE       1947-01-08 00:00:00</span></span>
<span><span class="co">#&gt; 2 Carrie Fisher actor         60 TRUE       1956-10-21 00:00:00</span></span>
<span><span class="co">#&gt; 3 Chuck Berry   musician      90 TRUE       1926-10-18 00:00:00</span></span>
<span><span class="co">#&gt; 4 Bill Paxton   actor         61 TRUE       1955-05-17 00:00:00</span></span>
<span><span class="co">#&gt; 5 Prince        musician      57 TRUE       1958-06-07 00:00:00</span></span>
<span><span class="co">#&gt; 6 Alan Rickman  actor         69 FALSE      1946-02-21 00:00:00</span></span>
<span><span class="co">#&gt; # ℹ 4 more rows</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: `Date of death` &lt;dttm&gt;</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="exportando-para-o-planilhas-google" class="level3" data-number="20.3.4"><h3 data-number="20.3.4" class="anchored" data-anchor-id="exportando-para-o-planilhas-google">
<span class="header-section-number">20.3.4</span> Exportando para o Planilhas Google</h3>
<p>Você pode exportar dados do R para o Planilhas Google com a função <code><a href="https://googlesheets4.tidyverse.org/reference/sheet_write.html">write_sheet()</a></code>. O primeiro argumento é o conjuntos de dados a ser exportado, o segundo argumento é o nome (ou outro identificador) da planilha a ser gravado no Planilhas Google:</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/sheet_write.html">write_sheet</a></span><span class="op">(</span><span class="va">doces_vendas</span>, ss <span class="op">=</span> <span class="st">"doces-vendas"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se você quiser exportar para uma planilha específica dentro de um arquivo do Planilhas Google, você poderá fazê-lo especificando o argumento <code>sheet</code> também.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/sheet_write.html">write_sheet</a></span><span class="op">(</span><span class="va">doces_vendas</span>, ss <span class="op">=</span> <span class="st">"doces-vendas"</span>, sheet <span class="op">=</span> <span class="st">"Vendas"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="autenticação" class="level3" data-number="20.3.5"><h3 data-number="20.3.5" class="anchored" data-anchor-id="autenticação">
<span class="header-section-number">20.3.5</span> Autenticação</h3>
<p>Apesar de você poder importar uma planilha pública com sua conta do Google e a função <code><a href="https://googlesheets4.tidyverse.org/reference/gs4_deauth.html">gs4_deauth()</a></code>, importar uma planilha privada ou exportar para uma requer autenticação para que o pacote googlesheets4 possa acessar e gerenciar <em>suas</em> Planilhas Google.</p>
<p>Quando você tenta acessar uma planilha que requer autenticação, o googlesheets4 irá te redirecionar para um navegador web e pedir sua conta do Google para obter a permissão de operar as planilhas em seu lugar. Entretanto, se você quiser definir uma conta específica, escopo de autenticação, etc, você pode fazer através da <code><a href="https://googlesheets4.tidyverse.org/reference/gs4_auth.html">gs4_auth()</a></code>, ex: <code>gs4_auth(email = "meu@exemplo.com")</code>, o qual irá forçar o uso de um <em>token</em> associado a este email específico. Para mais informações sobre autenticação, recomendamos ler a documentação do googlesheets4 (<em>auth vignette</em>) em <a href="https://googlesheets4.tidyverse.org/articles/auth.html" class="uri">https://googlesheets4.tidyverse.org/articles/auth.html</a>.</p>
</section><section id="exercícios-1" class="level3" data-number="20.3.6"><h3 data-number="20.3.6" class="anchored" data-anchor-id="exercícios-1">
<span class="header-section-number">20.3.6</span> Exercícios</h3>
<ol type="1">
<li><p>Importe o conjunto de dados <code>estudantes</code> visto anteriormente neste capítulo do Excel e do Planilhas Google, sem argumentos adicionais usando as funções <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> e <code><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet()</a></code>. Os <em>data frames</em> resultantes são idênticos no R? Se não, quais as diferenças?</p></li>
<li><p>Importe a planilha chamada pesquisa do Planilhas Google de <a href="https://pos.it/r4ds-survey" class="uri">https://pos.it/r4ds-survey</a>, tendo <code>pesquisa_id</code> como uma variável texto (caractere) e <code>n_animais_estimacao</code> como numérica.</p></li>
<li>
<p>Importe do Planilhas Google o arquivo chamado lista de <a href="https://pos.it/r4ds-roster" class="uri">https://pos.it/r4ds-roster</a>. O <em>data frame</em> resultante deve se chamar <code>lista</code> e deve se parecer como mostrado abaixo.</p>
<div class="cell">
<pre><code>#&gt; # A tibble: 12 × 3
#&gt;    group subgroup    id
#&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
#&gt;  1     1 A            1
#&gt;  2     1 A            2
#&gt;  3     1 A            3
#&gt;  4     1 B            4
#&gt;  5     1 B            5
#&gt;  6     1 B            6
#&gt;  7     1 B            7
#&gt;  8     2 A            8
#&gt;  9     2 A            9
#&gt; 10     2 B           10
#&gt; 11     2 B           11
#&gt; 12     2 B           12</code></pre>
</div>
</li>
</ol></section></section><section id="resumo" class="level2" data-number="20.4"><h2 data-number="20.4" class="anchored" data-anchor-id="resumo">
<span class="header-section-number">20.4</span> Resumo</h2>
<p>O Microsoft Excel e o Planilhas Google são dois sistemas de planilhas muito populares. Ser capaz de interagir com dados armazenados no Excel e Planilhas Google diretamente do R é um superpoder! Neste capítulo você aprendeu a importar dados para o R de planilhas do Excel usando a <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> do pacote readxl e do Planilhas Google usando a <code><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet()</a></code> do pacote googlesheets4. Estas funções trabalham de forma muito parecidas e possuem argumentos similares para especificar nomes de colunas, valores não disponíveis (NA), pular linhas no início do arquivo que está importando, etc. Além disso, ambas funções permitem ler planilhas específicas de dentro dos respectivos arquivos.</p>
<p>Por outro lado, exportar para o Excel requer um pacote e função diferente (<code><a href="https://docs.ropensci.org/writexl/reference/write_xlsx.html">writexl::write_xlsx()</a></code>) enquanto você pode exportar para o Planilhas Google com o mesmo pacote googlesheets4, com a função <code><a href="https://googlesheets4.tidyverse.org/reference/sheet_write.html">write_sheet()</a></code>.</p>
<p>No próximo capítulo, você aprenderá sobre uma fonte de dados diferente e como importar dados desta fonte para o R: banco de dados (<em>databases</em>).</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./import.html" class="pagination-link  aria-label=" importar="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">✅ Importar</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./databases.html" class="pagination-link" aria-label="<span class='chapter-number'>21</span>&nbsp; <span class='chapter-title'>✅ Bancos de dados</span>">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">✅ Bancos de dados</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>R para Ciência de Dados (2ª edição) foi escrito por Hadley Wickham, Mine Çetinkaya-Rundel, e Garrett Grolemund.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/cienciadedatos/pt-r4ds/edit/main/spreadsheets.qmd" class="toc-action"><i class="bi bi-github"></i>Editar essa página</a></li><li><a href="https://github.com/cienciadedatos/pt-r4ds/issues/new" class="toc-action"><i class="bi empty"></i>Criar uma issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Este livro foi contruído com <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>